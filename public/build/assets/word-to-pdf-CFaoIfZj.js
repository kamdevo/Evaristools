import{r as s,j as e,H as S,a as W}from"./app-BUl2XNVK.js";import{B as j}from"./createLucideIcon-nQgsIK04.js";import{T as B,a as m}from"./ToolCard-DUmtgb5y.js";import{F as E}from"./FileUploadZone-Dme-ExYg.js";import{P as M}from"./ProgressBar-18-o6m3Z.js";import{C as O,A as U}from"./driver-TOg9fbSz.js";import{F as D}from"./file-down-B9zX4R8P.js";import{U as A}from"./upload-BNlRWnz8.js";import{F as L}from"./file-text-CLErbyE6.js";import{C as z}from"./circle-check-big-D3LO5hBg.js";import{L as R}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./badge-ClX4IzPs.js";import"./arrow-left-C3I9wMLH.js";import"./building-2-DsJ5nUpW.js";function re(){const[a,F]=s.useState(null),[p,g]=s.useState(!1),[N,f]=s.useState(!1),[o,n]=s.useState({current:0,total:0,message:""}),[P,u]=s.useState(!1),[v,i]=s.useState("");s.useRef(null);const w=()=>{U({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="left-column"]',popover:{title:"Paso 1: Seleccionar Word",description:"Arrastra tu documento Word (.doc o .docx) aquí o haz clic para seleccionarlo. Tamaño máximo: 25MB.",side:"right",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 2: Convertir a PDF",description:'Una vez cargado tu documento, haz clic en "Convertir a PDF" para procesarlo. El archivo PDF se descargará automáticamente.',side:"left",align:"start"}}]}).drive()},h=t=>{const r=t[0];if(!r)return;if(!["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"].includes(r.type)){i("Por favor selecciona un archivo Word válido (.docx o .doc).");return}if(r.size>10*1024*1024){i("El archivo es demasiado grande. Máximo 10MB permitido.");return}F(r),i(""),f(!1)},C=async()=>{if(a){g(!0),i(""),n({current:1,total:3,message:"Subiendo archivo Word..."});try{const t=new FormData;t.append("file",a),n({current:2,total:3,message:"Convirtiendo Word a PDF..."});const r=await W.post("/tools/word-to-pdf/convert",t,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},responseType:"blob",onUploadProgress:x=>{if(x.total){const T=Math.round(x.loaded*100/x.total);n({current:2,total:3,message:`Subiendo archivo... ${T}%`})}}});n({current:3,total:3,message:"Descargando PDF..."});const c=new Blob([r.data],{type:"application/pdf"}),l=window.URL.createObjectURL(c),d=document.createElement("a");d.href=l,d.download=`${a.name.replace(/\.(docx?|doc)$/i,"")}_converted.pdf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(l),n({current:3,total:3,message:"¡PDF descargado exitosamente!"}),f(!0)}catch(t){console.error("Error converting to PDF:",t);let r="Error al convertir el documento.";if(t.response)if(t.response.data instanceof Blob){const c=await t.response.data.text();try{const l=JSON.parse(c);r=l.error||l.message||r}catch{r=c||r}}else r=t.response.data?.error||t.response.data?.message||r;else t.request&&(r="No se pudo conectar con el servidor. Verifica tu conexión.");i(r),n({current:0,total:0,message:""})}finally{g(!1)}}},b=t=>{t.preventDefault(),u(!0)},k=t=>{t.preventDefault(),u(!1)},y=t=>{t.preventDefault(),u(!1),t.dataTransfer.files&&t.dataTransfer.files.length>0&&h(t.dataTransfer.files)};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{title:"Word a PDF - Evaristools",children:[e.jsx("meta",{name:"description",content:"Convierte documentos Word a PDF manteniendo el formato - Hospital Universitario del Valle"}),e.jsx("meta",{name:"csrf-token",content:document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""})]}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(B,{title:"Word a PDF",description:"Convierte documentos Word a PDF manteniendo todos los estilos, imágenes y formato original",icon:D}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6","data-tour":"left-column",children:[e.jsxs(m,{title:"Subir Documento Word",description:"Selecciona un archivo Word (.docx o .doc) para convertir a PDF. Máximo 10MB.",icon:A,children:[e.jsx(E,{onFileSelect:h,acceptedTypes:".docx,.doc,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword",multiple:!1,dragOver:P,onDragOver:b,onDragEnter:b,onDragLeave:k,onDrop:y,title:"Arrastra un documento Word aquí o haz clic para seleccionar",subtitle:"Archivos soportados: .docx, .doc (Máx. 10MB)",buttonText:"Seleccionar Documento"}),v&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800 dark:text-red-200",children:["⚠️ ",v]})})]}),a&&e.jsxs(m,{title:"Documento Seleccionado",description:"Información del archivo Word",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(a.size/1024/1024).toFixed(2)," MB"]})]})]})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"ℹ️ La conversión preservará todos los estilos, imágenes, tablas y formato del documento original."})})]}),p&&e.jsxs(m,{title:"Progreso de Conversión",children:[e.jsx(M,{progress:o.total>0?o.current/o.total*100:0,message:o.message,showPercentage:o.total>0}),o.total>0&&e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 text-center mt-2",children:["Paso ",o.current,"/",o.total]})]}),N&&!p&&e.jsx(m,{title:"¡Conversión Exitosa!",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(z,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:"¡PDF generado y descargado exitosamente!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"El archivo se ha guardado en tu carpeta de descargas."})]})]})})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(m,{title:"Acciones","data-tour":"actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{onClick:C,disabled:p||!a,className:"w-full bg-institutional hover:bg-institutional/90",children:p?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Convirtiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Convertir a PDF"]})}),e.jsxs(j,{onClick:w,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})})})]})})})]})]})}export{re as default};
