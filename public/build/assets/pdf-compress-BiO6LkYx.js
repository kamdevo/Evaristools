import{r as i,j as e,H as E}from"./app-Dsy0IDlY.js";import{a as I,B as f}from"./createLucideIcon-zWh7RBp2.js";import{L as v}from"./label-BR4GXGHh.js";import{S as L,a as U,b as q,c as H,d as C}from"./select-Bow1geSY.js";import{P as V}from"./PDFButton-ZWt0sIT_.js";import{T as _,a as b}from"./ToolCard-BJ-ndep7.js";import{F as Z}from"./FileUploadZone-CO3fHbvG.js";import{C as K,A as G}from"./driver-CbK6X61E.js";import{U as $}from"./upload-BWVwj-oL.js";import{L as J}from"./loader-circle-DCybTZ4F.js";import{D as Q}from"./download-EoT1easo.js";import"./app-Cr7akxs5.js";import"./index-CFqedylX.js";import"./index-W7Zru7-9.js";import"./index-CGkeVF3S.js";import"./index-BE5e8sKO.js";import"./index-C1NcU4F2.js";import"./index-DL-wnNzJ.js";import"./check-DwjS1fVa.js";import"./badge-C5hIH6o_.js";import"./arrow-left-DYa5KCgZ.js";import"./building-2-hOcPt7xx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],D=I("Zap",W);function Ce(){const[l,N]=i.useState(null),[y,P]=i.useState(!1),[u,m]=i.useState(null),[c,F]=i.useState(0),[k,p]=i.useState(0),[z,h]=i.useState(0),[r,j]=i.useState({quality:"medium",removeMetadata:!0,optimizeImages:!0}),S=i.useRef(null);i.useRef(null);const B=()=>{G({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir PDF",description:"Arrastra tu archivo PDF aquí o haz clic para seleccionarlo. El sistema analizará el tamaño original para mostrar la reducción.",side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar Compresión",description:"Selecciona la calidad de compresión y opciones adicionales como remover metadatos u optimizar imágenes.",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Comprimir y Descargar",description:'Haz clic en "Comprimir PDF" para procesar. Verás el porcentaje de reducción y podrás descargar el archivo comprimido.',side:"left",align:"start"}}]}).drive()},g=a=>{if(a===0)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(a)/Math.log(t));return parseFloat((a/Math.pow(t,n)).toFixed(2))+" "+s[n]},M=a=>{if(a.type!=="application/pdf"){alert("Por favor selecciona un archivo PDF válido.");return}N(a),F(a.size),m(null),p(0),h(0)},O=async()=>{if(l){P(!0);try{const a=await l.arrayBuffer(),t=await V.load(a);r.removeMetadata&&(t.setTitle(""),t.setAuthor(""),t.setSubject(""),t.setKeywords([]),t.setCreator("Evaristools - Hospital Universitario del Valle"),t.setProducer("Evaristools PDF Compressor"));const s=t.getPages();for(let o=0;o<s.length;o++){const w=s[o];try{const d=w.getMediaBox();w.setMediaBox(d.x,d.y,d.width,d.height)}catch(d){console.warn(`Could not optimize page ${o+1}:`,d)}}let n={useObjectStreams:!0,addDefaultPage:!1,updateFieldAppearances:!1};switch(r.quality){case"low":n.useObjectStreams=!0;break;case"medium":n.useObjectStreams=!0;break;case"high":n.useObjectStreams=!1;break}const x=await t.save(n);if(x.length>=c){const o=await t.save({useObjectStreams:!1,addDefaultPage:!1});if(o.length<c)m(o),p(o.length);else{alert("Este PDF ya está optimizado. No se puede reducir más su tamaño sin pérdida significativa de calidad."),m(null),p(0),h(0);return}}else m(x),p(x.length);const A=(c-(u?.length||x.length))/c*100;h(Math.max(0,A))}catch(a){console.error("Error comprimiendo PDF:",a),alert("Error al comprimir el PDF. Por favor intenta con otro archivo.")}finally{P(!1)}}},R=()=>{if(!u||!l)return;const a=new Blob([u],{type:"application/pdf"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=l.name.replace(".pdf","_comprimido.pdf"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},T=()=>{N(null),m(null),F(0),p(0),h(0),S.current&&(S.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Compresor de PDF - Evaristools",children:e.jsx("meta",{name:"description",content:"Comprime archivos PDF reduciendo su tamaño sin perder calidad - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(_,{title:"Compresor de PDF",description:"Reduce el tamaño de tus archivos PDF sin perder calidad",icon:D}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsx("div",{className:"space-y-6","data-tour":"upload",children:e.jsxs(b,{title:"Subir PDF",description:"Selecciona o arrastra tu archivo PDF para comprimir",icon:$,children:[e.jsx(Z,{onFileSelect:a=>M(a[0]),acceptedTypes:".pdf"}),l&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"Archivo:"})," ",l.name]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"Tamaño original:"})," ",g(c)]}),e.jsx(f,{onClick:T,variant:"outline",className:"w-full",children:"Cambiar Archivo"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(b,{title:"Opciones de Compresión","data-tour":"options",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"quality",children:"Nivel de Compresión"}),e.jsxs(L,{value:r.quality,onValueChange:a=>j({...r,quality:a}),children:[e.jsx(U,{children:e.jsx(q,{})}),e.jsxs(H,{children:[e.jsx(C,{value:"low",children:"Baja (Mayor compresión)"}),e.jsx(C,{value:"medium",children:"Media (Balanceada)"}),e.jsx(C,{value:"high",children:"Alta (Mejor calidad)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"removeMetadata",checked:r.removeMetadata,onChange:a=>j({...r,removeMetadata:a.target.checked}),className:"rounded"}),e.jsx(v,{htmlFor:"removeMetadata",children:"Remover metadatos"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"optimizeImages",checked:r.optimizeImages,onChange:a=>j({...r,optimizeImages:a.target.checked}),className:"rounded"}),e.jsx(v,{htmlFor:"optimizeImages",children:"Optimizar imágenes"})]})]})}),e.jsxs(b,{title:"Acciones",children:[e.jsxs("div",{className:"space-y-3","data-tour":"actions",children:[e.jsx(f,{onClick:O,disabled:!l||y,className:"w-full bg-institutional hover:bg-institutional/90",children:y?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 mr-2 animate-spin"}),"Comprimiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Comprimir PDF"]})}),e.jsxs(f,{onClick:B,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]}),u&&e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Resultado de la Compresión"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Tamaño Original"}),e.jsx("p",{className:"font-medium",children:g(c)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Tamaño Comprimido"}),e.jsx("p",{className:"font-medium",children:g(k)})]})]}),e.jsxs("div",{className:"bg-institutional/10 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Reducción de tamaño"}),e.jsxs("p",{className:"text-lg font-bold text-institutional",children:[z.toFixed(1),"%"]})]}),e.jsxs(f,{onClick:R,className:"w-full bg-institutional hover:bg-institutional/90 text-white",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Descargar PDF Comprimido"]})]})]})]})]})})})]})]})}export{Ce as default};
