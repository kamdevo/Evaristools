import{r as i,j as e,H as Z}from"./app-Dsy0IDlY.js";import{a as J,B as h}from"./createLucideIcon-zWh7RBp2.js";import{I as k}from"./input-9VeK_OJz.js";import{L as f}from"./label-BR4GXGHh.js";import{S as z,a as I,b as T,c as E,d as o}from"./select-Bow1geSY.js";import{T as K,a as x}from"./ToolCard-BJ-ndep7.js";import{F as Q}from"./FileUploadZone-CO3fHbvG.js";import{P as X,S as Y,d as ee,r as ae}from"./PDFButton-ZWt0sIT_.js";import{C as te,A as re}from"./driver-CbK6X61E.js";import{F as se}from"./file-text-CUPYY9vv.js";import{C as oe}from"./circle-check-big-DMF8tN96.js";import{D as ie}from"./download-EoT1easo.js";import{U as O}from"./upload-BWVwj-oL.js";import{L as le}from"./loader-circle-DCybTZ4F.js";import"./app-Cr7akxs5.js";import"./index-CFqedylX.js";import"./index-W7Zru7-9.js";import"./index-CGkeVF3S.js";import"./index-BE5e8sKO.js";import"./index-C1NcU4F2.js";import"./index-DL-wnNzJ.js";import"./check-DwjS1fVa.js";import"./badge-C5hIH6o_.js";import"./arrow-left-DYa5KCgZ.js";import"./building-2-hOcPt7xx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],B=J("Droplet",ce);function Oe(){const[s,F]=i.useState(null),[v,w]=i.useState(!1),[L,b]=i.useState(!1),[p,N]=i.useState(""),[S,l]=i.useState(""),[ne,de]=i.useState(!1),[t,c]=i.useState({text:"CONFIDENCIAL",position:"diagonal",opacity:.3,fontSize:48,color:"#808080"}),R=i.useRef(null),U=()=>{re({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir PDF",description:"Selecciona el archivo PDF al que deseas agregar una marca de agua.",side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar Marca de Agua",description:"Escribe el texto de la marca de agua, ajusta su posición, tamaño, opacidad y rotación.",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Aplicar Marca de Agua",description:'Haz clic en "Aplicar Marca de Agua" para procesar. La marca se aplicará a todas las páginas del PDF.',side:"left",align:"start"}}]}).drive()},C=a=>{const r=a[0];if(r){if(r.type!=="application/pdf"){l("Por favor selecciona un archivo PDF válido.");return}if(r.size>50*1024*1024){l("El archivo es demasiado grande. Máximo 50MB permitido.");return}F(r),l(""),b(!1),N("")}},H=a=>{const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return r?{r:parseInt(r[1],16)/255,g:parseInt(r[2],16)/255,b:parseInt(r[3],16)/255}:{r:.5,g:.5,b:.5}},W=async()=>{if(!s||!t.text.trim()){l("Por favor ingresa el texto de la marca de agua.");return}w(!0),l("");try{const a=await s.arrayBuffer(),r=await X.load(a),V=r.getPages(),A=await r.embedFont(Y.HelveticaBold),y=H(t.color);V.forEach(D=>{const{width:u,height:j}=D.getSize(),g=A.widthOfTextAtSize(t.text,t.fontSize),M=t.fontSize;let n,d,m;switch(t.position){case"center":n=(u-g)/2,d=(j-M)/2,m=0;break;case"diagonal":n=u/2-g/2,d=j/2,m=45;break;case"top":n=(u-g)/2,d=j-M-50,m=0;break;case"bottom":n=(u-g)/2,d=50,m=0;break;default:n=(u-g)/2,d=j/2,m=45}D.drawText(t.text,{x:n,y:d,size:t.fontSize,font:A,color:ae(y.r,y.g,y.b),opacity:t.opacity,rotate:ee(m)})});const _=await r.save(),q=new Blob([_],{type:"application/pdf"}),$=URL.createObjectURL(q);N($),b(!0)}catch(a){console.error("Error adding watermark:",a),l("Error al agregar la marca de agua. Por favor intenta de nuevo.")}finally{w(!1)}},G=()=>{if(!p||!s)return;const a=document.createElement("a");a.href=p,a.download=`${s.name.replace(".pdf","")}_marcado.pdf`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},P=()=>{F(null),b(!1),N(""),l(""),p&&URL.revokeObjectURL(p)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Marca de Agua en PDF - Evaristools"}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(K,{title:"Marca de Agua en PDF",description:"Añade marcas de agua personalizadas a tus documentos PDF",icon:B}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[!s&&e.jsxs(x,{title:"Seleccionar PDF","data-tour":"upload",children:[e.jsx(Q,{onFileSelect:C,acceptedTypes:".pdf",title:"Arrastra tu PDF aquí",subtitle:"o haz clic para seleccionar (máximo 50MB)"}),e.jsx("input",{ref:R,type:"file",accept:".pdf",onChange:a=>a.target.files&&C(a.target.files),className:"hidden"})]}),S&&e.jsx(x,{title:"Error",children:e.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-800 dark:text-red-200",children:S})})}),s&&e.jsx(x,{title:"Archivo Seleccionado",children:e.jsx("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(se,{className:"h-8 w-8 text-institutional"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]})})}),L&&p&&e.jsx(x,{title:"¡Marca de Agua Agregada!",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(oe,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:"¡La marca de agua se agregó correctamente!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"Descarga tu PDF marcado o procesa otro archivo."})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(h,{onClick:G,className:"flex-1 bg-institutional hover:bg-institutional/90",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Descargar PDF con Marca de Agua"]}),e.jsxs(h,{onClick:P,variant:"outline",className:"flex-1",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Marcar Otro PDF"]})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(x,{title:"Opciones de Marca de Agua","data-tour":"options",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"watermark-text",children:"Texto de la Marca de Agua"}),e.jsx(k,{id:"watermark-text",type:"text",value:t.text,onChange:a=>c({...t,text:a.target.value}),placeholder:"Ej: CONFIDENCIAL, BORRADOR, etc.",maxLength:50})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Posición"}),e.jsxs(z,{value:t.position,onValueChange:a=>c({...t,position:a}),children:[e.jsx(I,{children:e.jsx(T,{})}),e.jsxs(E,{children:[e.jsx(o,{value:"diagonal",children:"Diagonal (Centro)"}),e.jsx(o,{value:"center",children:"Centro Horizontal"}),e.jsx(o,{value:"top",children:"Superior"}),e.jsx(o,{value:"bottom",children:"Inferior"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Tamaño de Fuente"}),e.jsxs(z,{value:t.fontSize.toString(),onValueChange:a=>c({...t,fontSize:parseInt(a)}),children:[e.jsx(I,{children:e.jsx(T,{})}),e.jsxs(E,{children:[e.jsx(o,{value:"24",children:"24pt - Pequeño"}),e.jsx(o,{value:"36",children:"36pt - Mediano"}),e.jsx(o,{value:"48",children:"48pt - Grande"}),e.jsx(o,{value:"60",children:"60pt - Muy Grande"}),e.jsx(o,{value:"72",children:"72pt - Extra Grande"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{htmlFor:"opacity",children:["Opacidad: ",Math.round(t.opacity*100),"%"]}),e.jsx("input",{id:"opacity",type:"range",min:"0.1",max:"1",step:"0.1",value:t.opacity,onChange:a=>c({...t,opacity:parseFloat(a.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"color",children:"Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{id:"color",type:"color",value:t.color,onChange:a=>c({...t,color:a.target.value}),className:"w-20 h-10"}),e.jsx(k,{type:"text",value:t.color,onChange:a=>c({...t,color:a.target.value}),placeholder:"#808080",className:"flex-1"})]})]}),e.jsxs("div",{className:"p-6 bg-slate-100 dark:bg-slate-800 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:"Vista Previa:"}),e.jsx("div",{className:"relative h-40 bg-white dark:bg-slate-700 rounded flex items-center justify-center overflow-hidden",children:e.jsx("p",{className:"font-bold",style:{fontSize:`${t.fontSize*.5}px`,color:t.color,opacity:t.opacity,transform:t.position==="diagonal"?"rotate(-45deg)":"none"},children:t.text||"MARCA DE AGUA"})})]})]})}),e.jsxs(x,{title:"Acciones","data-tour":"actions",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(h,{onClick:W,disabled:v||!s||!t.text.trim(),className:"flex-1 bg-institutional hover:bg-institutional/90",children:v?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"mr-2 h-4 w-4 animate-spin"}),"Agregando Marca de Agua..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Agregar Marca de Agua"]})}),e.jsxs(h,{onClick:P,variant:"outline",className:"flex-1",disabled:v,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Seleccionar Otro PDF"]})]}),e.jsxs(h,{onClick:U,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})]})]})})})]})]})}export{Oe as default};
