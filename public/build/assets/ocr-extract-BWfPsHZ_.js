import{r as o,j as e,H as M,a as D}from"./app-Dsy0IDlY.js";import{a as G,B as x}from"./createLucideIcon-zWh7RBp2.js";import{L as A}from"./label-BR4GXGHh.js";import{S as q,a as V,b as H,c as z,d as v}from"./select-Bow1geSY.js";import{C as J,A as _}from"./driver-CbK6X61E.js";import{T as $,a as g}from"./ToolCard-BJ-ndep7.js";import{F as K}from"./FileUploadZone-CO3fHbvG.js";import{P as X}from"./ProgressBar-NICG7Q8V.js";import{U as Z}from"./upload-BWVwj-oL.js";import{E as Q}from"./eye-Bmm-PvLL.js";import{S as W}from"./sticky-note-BEGMtK2p.js";import{C as Y}from"./check-DwjS1fVa.js";import{C as ee}from"./copy-DTXshfan.js";import{D as te}from"./download-EoT1easo.js";import{L as ae}from"./loader-circle-DCybTZ4F.js";import"./app-Cr7akxs5.js";import"./index-CFqedylX.js";import"./index-W7Zru7-9.js";import"./index-CGkeVF3S.js";import"./index-BE5e8sKO.js";import"./index-C1NcU4F2.js";import"./index-DL-wnNzJ.js";import"./badge-C5hIH6o_.js";import"./arrow-left-DYa5KCgZ.js";import"./building-2-hOcPt7xx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}]],c=G("ScanText",re);function Fe(){const[s,N]=o.useState(null),[b,S]=o.useState(""),[h,C]=o.useState(!1),[y,n]=o.useState(0),[l,d]=o.useState(""),[T,f]=o.useState(0),[E,m]=o.useState(""),[P,p]=o.useState(!1),[u,F]=o.useState({language:"spa+eng",outputFormat:"text"});o.useRef(null);const k=()=>{_({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir Imagen",description:"Selecciona una imagen (JPG, PNG, etc.) que contenga texto. El sistema usar√° OCR para extraer el texto autom√°ticamente.",side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar OCR",description:"Selecciona el idioma del texto en la imagen. El OCR funciona mejor con im√°genes de alta calidad y texto claro.",side:"left",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 3: Extraer y Ver Resultados",description:'Haz clic en "Extraer Texto" para procesar la imagen. El texto extra√≠do aparecer√° debajo y podr√°s copiarlo o descargarlo.',side:"left",align:"start"}}]}).drive()};o.useRef(null);const j=o.useRef(null),R=["image/jpeg","image/jpg","image/png","image/bmp","image/tiff"],I=t=>{if(t.type==="application/pdf"){alert(`‚ö†Ô∏è Los archivos PDF no son soportados directamente por el OCR.

üí° Sugerencias:
‚Ä¢ Convierte las p√°ginas del PDF a im√°genes (JPG/PNG)
‚Ä¢ Usa herramientas como "PDF a Im√°genes"
‚Ä¢ Toma capturas de pantalla de las p√°ginas

Formatos soportados: JPG, PNG, BMP, TIFF`);return}if(!R.includes(t.type)){alert(`Por favor selecciona un archivo de imagen v√°lido.

Formatos soportados: JPG, PNG, BMP, TIFF`);return}N(t),d(""),f(0),n(0);const a=URL.createObjectURL(t);S(a)},O=async()=>{if(!s)return;C(!0),n(0),d(""),f(0);let t=null;try{m("Preparando archivo..."),n(10);const a=new FormData;a.append("file",s),a.append("language",u.language),m("Extrayendo texto de la imagen... (esto puede tomar hasta 2 minutos)"),n(30),t=setInterval(()=>{n(i=>i<85?i+1:i)},1e3);const r=await D.post("/tools/ocr-extract/extract",a,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},timeout:12e4,onUploadProgress:i=>{if(i.total){const w=Math.round(i.loaded*100/i.total);w<100&&n(10+w*.2)}}});if(t&&clearInterval(t),n(90),r.data.success)d(r.data.text),f(r.data.confidence),m("¬°Texto extra√≠do exitosamente!"),n(100);else throw new Error(r.data.error||"Error al procesar")}catch(a){t&&clearInterval(t),console.error("Error extrayendo texto:",a);let r="Error al extraer texto de la imagen. Por favor intenta con otra imagen.";a.code==="ECONNABORTED"||a.message?.includes("timeout")?r=`‚è±Ô∏è El procesamiento est√° tomando m√°s tiempo del esperado.

üí° Sugerencias:
‚Ä¢ Intenta con una imagen m√°s peque√±a
‚Ä¢ Aseg√∫rate de que la imagen sea clara y de buena calidad
‚Ä¢ Verifica tu conexi√≥n a internet
‚Ä¢ Si el problema persiste, intenta de nuevo en unos momentos`:a.response?.data?.error?r=a.response.data.error:a.message&&(r=a.message),alert(r),m("Error en el procesamiento")}finally{C(!1),y!==100&&n(0)}},L=()=>{if(!l||!s)return;const t=new Blob([l],{type:"text/plain"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a;const i=s.name.replace(/\.[^/.]+$/,"")+"_texto_extraido.txt";r.download=i,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},U=async()=>{if(l)try{await navigator.clipboard.writeText(l),p(!0),setTimeout(()=>p(!1),2e3)}catch(t){console.error("Error copiando al portapapeles:",t),j.current&&(j.current.select(),document.execCommand("copy"),p(!0),setTimeout(()=>p(!1),2e3))}},B=t=>{switch(t){case"spa":return"Espa√±ol";case"eng":return"Ingl√©s";case"spa+eng":return"Espa√±ol + Ingl√©s";default:return t}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"OCR y Extracci√≥n de Texto - Evaristools",children:e.jsx("meta",{name:"description",content:"Extrae texto de im√°genes y documentos PDF escaneados - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx($,{title:"OCR y Extracci√≥n de Texto",description:"Convierte im√°genes en texto editable mediante OCR",icon:c,showPopularBadge:!0}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(g,{title:"Subir Imagen","data-tour":"upload",description:"Selecciona una imagen para extraer el texto mediante OCR",icon:Z,children:e.jsx(K,{onFileSelect:t=>I(t[0]),acceptedTypes:".jpg,.jpeg,.png,.bmp,.tiff",multiple:!1,hasFiles:!!s,title:"Arrastra tu archivo aqu√≠",subtitle:"Soporta JPG, PNG, BMP, TIFF",buttonText:"Seleccionar Archivo",fileInfo:s?e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-12 w-12 mx-auto text-institutional"}),e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Listo para procesar"})]}):void 0})}),b&&e.jsx(g,{title:"Vista Previa",icon:Q,children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:s?.type==="application/pdf"?e.jsxs("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-800",children:[e.jsx(W,{className:"h-16 w-16 mx-auto text-slate-400 mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Archivo PDF listo para procesar"})]}):e.jsx("img",{src:b,alt:"Vista previa",className:"w-full h-auto max-h-96 object-contain"})})})]}),e.jsxs("div",{className:"space-y-6",children:[l&&e.jsxs(g,{title:"Texto Extra√≠do",description:`Idioma: ${B(u.language)} - Confianza: ${T}%`,icon:c,children:[e.jsx("textarea",{ref:j,value:l,onChange:t=>d(t.target.value),placeholder:"El texto extra√≠do aparecer√° aqu√≠...",className:"min-h-48 resize-vertical w-full p-3 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-institutional focus:border-transparent",rows:12}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{onClick:U,variant:"outline",className:"flex-1",disabled:P,children:P?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Copiado"]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Copiar"]})}),e.jsxs(x,{onClick:L,className:"flex-1 bg-institutional hover:bg-institutional/90 text-white",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Descargar"]})]})]}),e.jsxs(g,{title:"Opciones de OCR","data-tour":"options",description:"Configura el reconocimiento √≥ptico de caracteres",icon:c,children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"language",children:"Idioma de Reconocimiento"}),e.jsxs(q,{value:u.language,onValueChange:t=>F({...u,language:t}),children:[e.jsx(V,{children:e.jsx(H,{})}),e.jsxs(z,{children:[e.jsx(v,{value:"spa+eng",children:"Espa√±ol + Ingl√©s"}),e.jsx(v,{value:"spa",children:"Solo Espa√±ol"}),e.jsx(v,{value:"eng",children:"Solo Ingl√©s"})]})]})]}),e.jsx(x,{onClick:O,disabled:!s||h,className:"w-full bg-institutional hover:bg-institutional/90",children:h?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2 animate-spin"}),E]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Extraer Texto"]})}),h&&e.jsx(X,{progress:y,message:"Progreso",showPercentage:!0}),e.jsxs(x,{onClick:k,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"¬øC√≥mo funciona? - Tour Interactivo"]})]})]})]})})})]})]})}export{Fe as default};
