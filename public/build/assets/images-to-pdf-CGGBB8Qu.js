import{r as c,j as e,H as Z}from"./app-Dsy0IDlY.js";import{B as u}from"./createLucideIcon-zWh7RBp2.js";import{L as P}from"./label-BR4GXGHh.js";import{P as _,a as K}from"./PDFButton-ZWt0sIT_.js";import{C as Q,A as X}from"./driver-CbK6X61E.js";import{T as Y,a as p}from"./ToolCard-BJ-ndep7.js";import{F as ee}from"./FileUploadZone-CO3fHbvG.js";import{P as te}from"./ProgressBar-NICG7Q8V.js";import{F as ae}from"./file-image-P1MTJbhj.js";import{T as R}from"./trash-2-BWMY2s-Y.js";import{A as se,a as re}from"./arrow-up-d86LOr_Y.js";import{L as ie}from"./loader-circle-DCybTZ4F.js";import{D as ne}from"./download-EoT1easo.js";import{U as oe}from"./upload-BWVwj-oL.js";import"./app-Cr7akxs5.js";import"./index-CFqedylX.js";import"./badge-C5hIH6o_.js";import"./arrow-left-DYa5KCgZ.js";import"./building-2-hOcPt7xx.js";function ke(){const[n,x]=c.useState([]),[f,C]=c.useState(!1),[d,g]=c.useState({current:0,total:0,message:""}),[m,v]=c.useState({size:"A4",orientation:"portrait",margin:50,quality:85}),[U,w]=c.useState(!1),O=c.useRef(null),B=()=>{X({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir Imágenes",description:"Selecciona múltiples imágenes (JPG, PNG, etc.) que deseas convertir en un solo PDF. Puedes arrastrarlas o hacer clic para seleccionar.",side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar PDF",description:"Ajusta el tamaño de página, orientación y márgenes. Puedes reordenar las imágenes arrastrándolas en la lista.",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Crear PDF",description:'Haz clic en "Crear PDF" para generar el documento. El PDF se descargará automáticamente con todas tus imágenes.',side:"left",align:"start"}}]}).drive()},E=t=>new Promise(a=>{const s=document.createElement("img");s.onload=()=>{a({width:s.width,height:s.height})},s.src=URL.createObjectURL(t)}),F=c.useCallback(async t=>{const a=["image/jpeg","image/png","image/webp","image/bmp","image/tiff"],s=Array.from(t).filter(r=>a.includes(r.type));if(s.length===0){alert("Por favor, selecciona solo archivos de imagen válidos (JPG, PNG, WEBP, BMP, TIFF)");return}g({current:0,total:s.length,message:"Cargando imágenes..."});const o=[];for(let r=0;r<s.length;r++){const i=s[r],l=await E(i),h={id:Math.random().toString(36).substr(2,9),file:i,url:URL.createObjectURL(i),width:l.width,height:l.height};o.push(h),g({current:r+1,total:s.length,message:`Cargando imagen ${r+1} de ${s.length}`})}x(r=>[...r,...o]),g({current:0,total:0,message:""})},[]),H=c.useCallback(t=>{t.preventDefault(),w(!1);const a=t.dataTransfer.files;a.length>0&&F(a)},[F]),I=c.useCallback(t=>{t.preventDefault(),w(!0)},[]),G=c.useCallback(t=>{t.preventDefault(),w(!1)},[]),q=t=>{x(a=>{const s=a.filter(r=>r.id!==t),o=a.find(r=>r.id===t);return o&&URL.revokeObjectURL(o.url),s})},L=(t,a)=>{x(s=>{const o=s.findIndex(l=>l.id===t);if(o===-1)return s;const r=a==="up"?o-1:o+1;if(r<0||r>=s.length)return s;const i=[...s];return[i[o],i[r]]=[i[r],i[o]],i})},$=()=>{n.forEach(t=>URL.revokeObjectURL(t.url)),x([])},M=async()=>{if(n.length===0){alert("Por favor, selecciona al menos una imagen para convertir a PDF");return}C(!0),g({current:0,total:n.length,message:"Creando documento PDF..."});try{const t=await _.create(),a=K[m.size];for(let l=0;l<n.length;l++){const h=n[l];g({current:l+1,total:n.length,message:`Procesando imagen ${l+1} de ${n.length}...`});const A=t.addPage(m.orientation==="landscape"?[a[1],a[0]]:a),{width:T,height:z}=A.getSize(),N=T-m.margin*2,y=z-m.margin*2,S=await h.file.arrayBuffer();let D;h.file.type==="image/png"?D=await t.embedPng(S):D=await t.embedJpg(S);const k=h.width/h.height,W=N/y;let j,b;k>W?(j=N,b=N/k):(b=y,j=y*k);const J=(T-j)/2,V=(z-b)/2;A.drawImage(D,{x:J,y:V,width:j,height:b})}g({current:n.length,total:n.length,message:"Generando PDF final..."});const s=await t.save(),o=new Blob([s],{type:"application/pdf"}),r=URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=`imagenes-convertidas-${Date.now()}.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),g({current:0,total:0,message:"¡PDF generado exitosamente!"})}catch(t){console.error("Error al convertir imágenes a PDF:",t),alert("Error al convertir las imágenes a PDF. Por favor, inténtalo de nuevo.")}finally{C(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Imágenes a PDF - Evaristools",children:e.jsx("meta",{name:"description",content:"Convierte múltiples imágenes en un documento PDF - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(Y,{title:"Imágenes a PDF",description:"Convierte múltiples imágenes en un documento PDF",icon:ae}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{title:"Seleccionar Imágenes","data-tour":"upload",children:e.jsx(ee,{onFileSelect:F,acceptedTypes:"image/*",multiple:!0,dragOver:U,onDragOver:I,onDragEnter:I,onDragLeave:G,onDrop:H,title:"Arrastra imágenes aquí o haz clic para seleccionar",subtitle:"Formatos soportados: JPG, PNG, WEBP, BMP, TIFF",buttonText:"Seleccionar Imágenes"})}),e.jsxs(p,{title:"Opciones de PDF","data-tour":"options",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"pageSize",children:"Tamaño de página"}),e.jsxs("select",{id:"pageSize",value:m.size,onChange:t=>v(a=>({...a,size:t.target.value})),className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-institutional focus:border-institutional",children:[e.jsx("option",{value:"A4",children:"A4"}),e.jsx("option",{value:"A3",children:"A3"}),e.jsx("option",{value:"A5",children:"A5"}),e.jsx("option",{value:"Letter",children:"Letter"}),e.jsx("option",{value:"Legal",children:"Legal"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"orientation",children:"Orientación"}),e.jsxs("select",{id:"orientation",value:m.orientation,onChange:t=>v(a=>({...a,orientation:t.target.value})),className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-institutional focus:border-institutional",children:[e.jsx("option",{value:"portrait",children:"Vertical"}),e.jsx("option",{value:"landscape",children:"Horizontal"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"margin",children:"Margen (px)"}),e.jsx("input",{id:"margin",type:"number",min:"0",max:"200",value:m.margin,onChange:t=>v(a=>({...a,margin:parseInt(t.target.value)||50})),className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-institutional focus:border-institutional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"quality",children:"Calidad (%)"}),e.jsx("input",{id:"quality",type:"number",min:"50",max:"100",value:m.quality,onChange:t=>v(a=>({...a,quality:parseInt(t.target.value)||85})),className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-institutional focus:border-institutional"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[n.length>0&&e.jsxs(p,{title:`Imágenes seleccionadas (${n.length})`,children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(u,{variant:"outline",size:"sm",onClick:$,className:"text-red-600 hover:text-red-700",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Limpiar todo"]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:n.map((t,a)=>e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-800",children:[e.jsx("img",{src:t.url,alt:`Imagen ${a+1}`,className:"w-16 h-16 object-cover rounded-lg border border-slate-300 dark:border-slate-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.file.name}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[t.width," × ",t.height," px • ",(t.file.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>L(t.id,"up"),disabled:a===0,children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>L(t.id,"down"),disabled:a===n.length-1,children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>q(t.id),className:"text-red-600 hover:text-red-700",children:e.jsx(R,{className:"h-4 w-4"})})]})]},t.id))})]}),(d.total>0||f)&&e.jsxs(p,{title:"Progreso",children:[e.jsx(te,{progress:d.total>0?d.current/d.total*100:0,message:d.message,showPercentage:d.total>0}),d.total>0&&e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 text-center",children:[d.current,"/",d.total]})]}),e.jsx(p,{title:"Generar PDF","data-tour":"actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(u,{onClick:M,disabled:n.length===0||f,className:"flex-1 bg-institutional hover:bg-institutional/90",children:f?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-5 w-5 mr-2 animate-spin"}),"Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-5 w-5 mr-2"}),"Convertir a PDF"]})}),e.jsxs(u,{variant:"outline",onClick:()=>O.current?.click(),disabled:f,children:[e.jsx(oe,{className:"h-5 w-5 mr-2"}),"Agregar más imágenes"]})]}),e.jsxs(u,{onClick:B,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})})]})]})})})]})]})}export{ke as default};
