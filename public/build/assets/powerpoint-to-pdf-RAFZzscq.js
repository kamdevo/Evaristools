import{r as o,j as e,H as C,a as F}from"./app-BUl2XNVK.js";import{B as l}from"./createLucideIcon-nQgsIK04.js";import{T as y,a as n}from"./ToolCard-DUmtgb5y.js";import{F as k}from"./FileUploadZone-Dme-ExYg.js";import{C as T,A as D}from"./driver-TOg9fbSz.js";import{F as g}from"./file-down-B9zX4R8P.js";import{C as E}from"./circle-alert-DVH5G-gN.js";import{F as S}from"./file-text-CLErbyE6.js";import{C as B}from"./circle-check-big-D3LO5hBg.js";import{U as j}from"./upload-BNlRWnz8.js";import{L as A}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./badge-ClX4IzPs.js";import"./arrow-left-C3I9wMLH.js";import"./building-2-DsJ5nUpW.js";function Q(){const[s,m]=o.useState(null),[c,p]=o.useState(!1),[P,d]=o.useState(!1),[x,a]=o.useState(""),[O,L]=o.useState(!1),w=o.useRef(null),b=()=>{D({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="left-column"]',popover:{title:"Paso 1: Seleccionar PowerPoint",description:"Arrastra tu presentación PowerPoint (.ppt o .pptx) aquí o haz clic para seleccionarla. Tamaño máximo: 25MB.",side:"right",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 2: Convertir a PDF",description:'Una vez cargada tu presentación, haz clic en "Convertir a PDF". La conversión se procesará y el archivo se descargará automáticamente.',side:"left",align:"start"}}]}).drive()},u=t=>{const r=t[0];if(!r)return;if(!["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"].includes(r.type)){a("Por favor selecciona un archivo PowerPoint válido (.ppt o .pptx).");return}if(r.size>25*1024*1024){a("El archivo es demasiado grande. Máximo 25MB permitido.");return}m(r),a(""),d(!1)},N=async()=>{if(s){p(!0),a("");try{const t=new FormData;t.append("file",s);const r=await F.post("/tools/powerpoint-to-pdf/convert",t,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},responseType:"blob",timeout:12e4}),h=new Blob([r.data],{type:"application/pdf"}),v=window.URL.createObjectURL(h),i=document.createElement("a");i.href=v,i.download=`${s.name.replace(/\.(pptx?|ppt)$/i,"")}_converted.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(v),d(!0)}catch(t){console.error("Error converting to PDF:",t);let r="Error al convertir el documento.";t.response?.status===404?r="La conversión de PowerPoint a PDF requiere configuración adicional en el servidor. Contacta al administrador del sistema.":t.response?.status===500?r="Error en el servidor al procesar el archivo. Verifica que el archivo no esté corrupto.":t.code==="ECONNABORTED"&&(r="La conversión está tardando demasiado. Intenta con un archivo más pequeño."),a(r)}finally{p(!1)}}},f=()=>{m(null),d(!1),a("")};return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"PowerPoint a PDF - Evaristools"}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(y,{title:"PowerPoint a PDF",description:"Convierte presentaciones PowerPoint a formato PDF",icon:g}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6","data-tour":"left-column",children:[!s&&e.jsxs(n,{title:"Seleccionar PowerPoint",children:[e.jsx(k,{onFileSelect:u,acceptedTypes:".ppt,.pptx",title:"Arrastra tu presentación aquí",subtitle:"o haz clic para seleccionar (máximo 25MB)"}),e.jsx("input",{ref:w,type:"file",accept:".ppt,.pptx",onChange:t=>t.target.files&&u(t.target.files),className:"hidden"})]}),x&&e.jsx(n,{title:"Error",children:e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(E,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-red-800 dark:text-red-200",children:x})]})}),s&&e.jsx(n,{title:"Archivo Seleccionado",children:e.jsx("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{className:"h-8 w-8 text-institutional"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]})})}),P&&e.jsx(n,{title:"¡Conversión Exitosa!",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(B,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:"¡PDF generado y descargado exitosamente!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"El archivo se ha guardado en tu carpeta de descargas."})]})]}),e.jsxs(l,{onClick:f,variant:"outline",className:"w-full",children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Convertir Otro Archivo"]})]})})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(n,{title:"Acciones","data-tour":"actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(l,{onClick:N,disabled:c||!s,className:"flex-1 bg-institutional hover:bg-institutional/90",children:c?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Convirtiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Convertir a PDF"]})}),e.jsxs(l,{onClick:f,variant:"outline",className:"flex-1",disabled:c,children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Seleccionar Otro"]})]}),e.jsxs(l,{onClick:b,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})})})]})})})]})]})}export{Q as default};
