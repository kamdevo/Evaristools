import{r as m,j as e,H as le,L as oe}from"./app-BUl2XNVK.js";import{a as ce,B as p}from"./createLucideIcon-nQgsIK04.js";import{B as H,C as D,a as y,b as k,c as F,d as S}from"./badge-ClX4IzPs.js";import{L as C}from"./label-B-7Te5tz.js";import{P as R}from"./PDFButton-hZ4qujXN.js";import{C as de,A as me}from"./driver-TOg9fbSz.js";import{A as pe}from"./arrow-left-C3I9wMLH.js";import{F as E}from"./folder-output-9e_L-86J.js";import{B as xe}from"./building-2-DsJ5nUpW.js";import{U as he}from"./upload-BNlRWnz8.js";import{F as ue}from"./file-text-CLErbyE6.js";import{X as _}from"./x-LZ7JQ_06.js";import{D as q}from"./download-DCCcjE2b.js";import{L as ge}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./index-C9DtIOMg.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],V=ce("Scissors",fe);function $e(){const[o,N]=m.useState(null),[c,b]=m.useState(0),[B,P]=m.useState(!1),[je,x]=m.useState(0),[G,h]=m.useState(""),[u,g]=m.useState([]),[t,f]=m.useState({method:"pages",pagesPerSplit:1,customRanges:"",maxSizeMB:10}),j=m.useRef(null),Z=m.useRef(null),K=()=>{me({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir PDF",description:"Arrastra tu archivo PDF aquí o haz clic para subirlo. El sistema detectará automáticamente el número total de páginas.",side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar División",description:"Elige cómo dividir el PDF: por número de páginas por archivo o por rangos personalizados (ej: 1-5, 6-10).",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Dividir PDF",description:'Haz clic en "Dividir PDF" para procesar. Podrás descargar cada archivo individualmente o todos juntos en un ZIP.',side:"left",align:"start"}}]}).drive()},T=async s=>{if(s.type!=="application/pdf"){alert("Por favor selecciona un archivo PDF válido.");return}N(s),g([]),x(0);try{const a=await s.arrayBuffer(),r=(await R.load(a)).getPageCount();b(r)}catch(a){console.error("Error loading PDF:",a),alert("Error al cargar el PDF. El archivo podría estar dañado."),N(null),b(0)}},X=s=>{s.preventDefault(),s.stopPropagation()},J=s=>{s.preventDefault(),s.stopPropagation()},Q=s=>{s.preventDefault(),s.stopPropagation()},W=s=>{s.preventDefault(),s.stopPropagation();const a=Array.from(s.dataTransfer.files);a.length>0&&T(a[0])},L=s=>{const a=[];return s.split(",").map(r=>r.trim()).filter(r=>r).forEach((r,d)=>{if(r.includes("-")){const[i,l]=r.split("-").map(v=>parseInt(v.trim()));i&&l&&i<=l&&i>0&&l<=c&&a.push({start:i,end:l,name:`Páginas_${i}-${l}`})}else{const i=parseInt(r);i>0&&i<=c&&a.push({start:i,end:i,name:`Página_${i}`})}}),a},$=s=>{const a=[];let n=1,r=1;for(;n<=c;){const d=Math.min(n+s-1,c);a.push({start:n,end:d,name:`Parte_${r}`}),n=d+1,r++}return a},Y=async()=>{if(!o){alert("Por favor selecciona un archivo PDF primero.");return}let s=[];if(t.method==="pages")s=$(t.pagesPerSplit||1);else if(t.method==="ranges"){if(!t.customRanges?.trim()){alert("Por favor especifica los rangos de páginas (ej: 1-5, 10, 15-20).");return}if(s=L(t.customRanges),s.length===0){alert("Los rangos especificados no son válidos. Formato: 1-5, 10, 15-20");return}}else s=$(1);P(!0),x(0),h("Inicializando división..."),g([]);try{const a=await o.arrayBuffer(),n=await R.load(a),r=[];for(let d=0;d<s.length;d++){const i=s[d];h(`Creando ${i.name}... (${d+1}/${s.length})`);const l=await R.create();for(let w=i.start;w<=i.end;w++){const[ne]=await l.copyPages(n,[w-1]);l.addPage(ne)}const v=n.getTitle(),O=n.getAuthor(),U=n.getSubject();v&&l.setTitle(`${v} - ${i.name}`),O&&l.setAuthor(O),U&&l.setSubject(`${U} - Dividido con Evaristools`),l.setCreator("Evaristools - Hospital Universitario del Valle");const ae=await l.save(),te=new Blob([ae],{type:"application/pdf"}),re=URL.createObjectURL(te);r.push({name:`${i.name}.pdf`,url:re,pages:i.end-i.start+1});const ie=Math.round((d+1)/s.length*90);x(ie)}g(r),x(100),h(`¡${r.length} archivos PDF creados exitosamente!`)}catch(a){console.error("Error dividiendo PDF:",a),alert(`Error al dividir PDF: ${a instanceof Error?a.message:"Error desconocido"}`),h("Error en el procesamiento")}finally{setTimeout(()=>{u.length===0&&(P(!1),x(0),h(""))},2e3)}},z=s=>{const a=document.createElement("a");a.href=s.url,a.download=s.name,document.body.appendChild(a),a.click(),document.body.removeChild(a)},ee=()=>{u.forEach((s,a)=>{setTimeout(()=>{z(s)},a*100)})},A=()=>{u.forEach(s=>URL.revokeObjectURL(s.url)),g([]),P(!1),x(0),h("")},se=()=>{A(),N(null),b(0),j.current&&(j.current.value="")},M=s=>{if(s===0)return"0 Bytes";const a=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,r)).toFixed(2))+" "+n[r]},I=()=>c?t.method==="pages"?Math.ceil(c/(t.pagesPerSplit||1)):t.method==="ranges"&&t.customRanges?.trim()?L(t.customRanges).length:0:0;return e.jsxs(e.Fragment,{children:[e.jsx(le,{title:"Dividir PDF - Evaristools",children:e.jsx("meta",{name:"description",content:"Divide archivos PDF en múltiples documentos más pequeños - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-white/20 dark:bg-slate-800/80 dark:border-slate-700/20",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(oe,{href:"/",children:e.jsxs(p,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Volver"})]})}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-institutional/10 text-institutional",children:e.jsx(E,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Dividir PDF"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Separa un PDF en múltiples archivos más pequeños"})]})]}),e.jsxs(H,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{children:"HUV"})]})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{"data-tour":"upload",children:[e.jsxs(y,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(he,{className:"h-5 w-5"}),e.jsx("span",{children:"Subir Archivo PDF"})]}),e.jsx(F,{children:"Selecciona el archivo PDF que deseas dividir"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsx("div",{ref:Z,className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${o?"border-institutional bg-institutional/5":"border-slate-300 hover:border-institutional"}`,onDragOver:X,onDragEnter:J,onDragLeave:Q,onDrop:W,children:o?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{className:"h-12 w-12 mx-auto text-institutional"}),e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:o.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[c," páginas • ",M(o.size)]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Arrastra tu archivo PDF aquí"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Solo archivos PDF"})]})]})}),e.jsx("input",{ref:j,type:"file",accept:".pdf",onChange:s=>{const a=s.target.files?.[0];a&&T(a)},className:"hidden"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{onClick:()=>j.current?.click(),variant:"outline",className:"flex-1",children:"Seleccionar PDF"}),o&&e.jsx(p,{onClick:se,variant:"outline",className:"px-4",children:e.jsx(_,{className:"h-4 w-4"})})]}),o&&c>0&&e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Total Páginas"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:c})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Tamaño"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:M(o.size)})]})]})})]})]}),u.length>0&&e.jsxs(D,{children:[e.jsxs(y,{children:[e.jsxs(k,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-5 w-5"}),e.jsx("span",{children:"Archivos Generados"})]}),e.jsxs(H,{variant:"outline",children:[u.length," archivos"]})]}),e.jsx(F,{children:"Descarga individual o todos los archivos a la vez"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{onClick:ee,className:"flex-1 bg-institutional hover:bg-institutional/90",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Descargar Todos"]}),e.jsx(p,{onClick:A,variant:"outline",className:"px-4",children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:u.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-500",children:[s.pages," ",s.pages===1?"página":"páginas"]})]}),e.jsx(p,{size:"sm",onClick:()=>z(s),className:"ml-2",children:e.jsx(q,{className:"h-3 w-3"})})]},a))})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(D,{"data-tour":"options",children:[e.jsxs(y,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Opciones de División"})]}),e.jsx(F,{children:"Configura cómo dividir el archivo PDF"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Método de División"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"method",value:"pages",checked:t.method==="pages",onChange:s=>f({...t,method:s.target.value}),className:"text-institutional border-gray-300 focus:ring-institutional"}),e.jsx("span",{children:"Por número de páginas"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"method",value:"ranges",checked:t.method==="ranges",onChange:s=>f({...t,method:s.target.value}),className:"text-institutional border-gray-300 focus:ring-institutional"}),e.jsx("span",{children:"Por rangos específicos"})]})]})]}),t.method==="pages"&&e.jsxs("div",{children:[e.jsx(C,{htmlFor:"pagesPerSplit",children:"Páginas por archivo"}),e.jsx("input",{id:"pagesPerSplit",type:"number",min:"1",max:c||100,value:t.pagesPerSplit||1,onChange:s=>f({...t,pagesPerSplit:parseInt(s.target.value)||1}),className:"mt-1 w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:"Cada archivo contendrá esta cantidad de páginas"})]}),t.method==="ranges"&&e.jsxs("div",{children:[e.jsx(C,{htmlFor:"customRanges",children:"Rangos de páginas"}),e.jsx("input",{id:"customRanges",type:"text",placeholder:"1-5, 10, 15-20",value:t.customRanges||"",onChange:s=>f({...t,customRanges:s.target.value}),className:"mt-1 w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:"Formato: 1-5, 10, 15-20 (separar con comas)"})]}),o&&c>0&&I()>0&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:["Se generarán aproximadamente ",I()," archivos"]})})]}),e.jsxs("div",{className:"space-y-3","data-tour":"actions",children:[e.jsx(p,{onClick:Y,disabled:!o||B,className:"w-full bg-institutional hover:bg-institutional/90",children:B?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4 mr-2 animate-spin"}),G]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Dividir PDF"]})}),e.jsxs(p,{onClick:K,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})]})]})})]})})})]})]})}export{$e as default};
