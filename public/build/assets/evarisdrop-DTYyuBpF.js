import{j as e,r as u,a as D,H as Se}from"./app-Dsy0IDlY.js";import{a as O,T as ke}from"./ToolCard-BJ-ndep7.js";import{a as b,B as w,c as Ae}from"./createLucideIcon-zWh7RBp2.js";import{C as re,d as oe,B as M}from"./badge-C5hIH6o_.js";import{M as Y}from"./monitor-58AmJ2hB.js";import{c as Ie}from"./index-W7Zru7-9.js";import{P as ne}from"./index-CFqedylX.js";import{F as ie}from"./file-text-CUPYY9vv.js";import{X as W}from"./x-DlKZNpHo.js";import{I as ee}from"./input-9VeK_OJz.js";import{L as F}from"./label-BR4GXGHh.js";import{D as ce,a as Me,b as le,g as de,c as me,d as Oe,e as Pe}from"./dialog-BdBh6i07.js";import{c as Le,d as Ue,e as ze,f as $e}from"./tooltip-Cn7xmnHx.js";import{C as ue}from"./check-DwjS1fVa.js";import{C as _e}from"./copy-DTXshfan.js";import{U as he}from"./upload-BWVwj-oL.js";import{S as qe,a as Fe,b as Ge,c as He,d as Be}from"./select-Bow1geSY.js";import{A as Ve,b as We}from"./alert-Pmn2FO59.js";import{D as G}from"./download-EoT1easo.js";import{C as Je}from"./circle-alert-j2_uMDUs.js";import{C as Qe,A as Ke}from"./driver-CbK6X61E.js";import{S as Xe}from"./share-2--eGrk-K6.js";import"./app-Cr7akxs5.js";import"./arrow-left-DYa5KCgZ.js";import"./building-2-hOcPt7xx.js";import"./index-CGkeVF3S.js";import"./index-BE5e8sKO.js";import"./index-C1NcU4F2.js";import"./index-CDgGLzUr.js";import"./index-DL-wnNzJ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ye=b("ArrowRight",Ze);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],H=b("Clock",es);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],B=b("File",ss);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]],as=b("Laptop",ts);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],os=b("LogIn",rs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],is=b("Pen",ns);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ls=b("RotateCcw",cs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],pe=b("Send",ds);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],us=b("Smartphone",ms);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ps=b("User",hs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],fs=b("Users",xs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],vs=b("WifiHigh",gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],js=b("Wifi",Ns);var g=(s=>(s.DISCONNECTED="disconnected",s.CONNECTING="connecting",s.CONNECTED="connected",s.ERROR="error",s))(g||{}),v=(s=>(s.QUEUED="queued",s.PENDING="pending",s.ACCEPTED="accepted",s.REJECTED="rejected",s.UPLOADING="uploading",s.DOWNLOADING="downloading",s.COMPLETED="completed",s.FAILED="failed",s.CANCELLED="cancelled",s))(v||{}),_=(s=>(s.SAME_ROOM="same_room",s.NETWORK="network",s))(_||{});const P=s=>{if(s===0)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,a)).toFixed(2))+" "+o[a]},ys=s=>P(s)+"/s",Cs=s=>s<60?`${Math.round(s)}s`:s<3600?`${Math.round(s/60)}m`:`${Math.round(s/3600)}h`,ws=s=>{switch(s){case g.CONNECTED:return"Conectado";case g.CONNECTING:return"Conectando...";case g.DISCONNECTED:return"Desconectado";case g.ERROR:return"Error de Conexión";default:return"Desconocido"}},Es=s=>{switch(s){case v.PENDING:return"Pendiente";case v.UPLOADING:return"Enviando";case v.DOWNLOADING:return"Recibiendo";case v.COMPLETED:return"Completado";case v.FAILED:return"Fallido";case v.CANCELLED:return"Cancelado";default:return"Desconocido"}},Ds=s=>{switch(s){case"laptop":return e.jsx(as,{className:"w-6 h-6"});case"mobile":return e.jsx(us,{className:"w-6 h-6"});case"desktop":return e.jsx(Y,{className:"w-6 h-6"});default:return e.jsx(Y,{className:"w-6 h-6"})}},bs=s=>{switch(s){case g.CONNECTED:return"default";case g.CONNECTING:return"secondary";case g.DISCONNECTED:return"outline";case g.ERROR:return"destructive";default:return"outline"}},Rs=(s,t)=>s===_.SAME_ROOM?e.jsxs(M,{variant:"default",className:"text-xs gap-1",children:[e.jsx(fs,{className:"w-3 h-3"}),"Misma Sala",t&&e.jsxs("span",{className:"opacity-75",children:["(",t,")"]})]}):e.jsxs(M,{variant:"outline",className:"text-xs gap-1",children:[e.jsx(js,{className:"w-3 h-3"}),"Red Local"]});function Ts({device:s,onSendFiles:t,hasQueuedFiles:o}){const a=s.status===g.CONNECTED&&o;return e.jsx(re,{className:"glass-card border-white/30 bg-white/60 hover-lift hover:bg-white/80 dark:bg-slate-800/60 dark:hover:bg-slate-800/80",children:e.jsxs(oe,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:Ds(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:s.name}),e.jsx(M,{variant:bs(s.status),className:"text-xs",children:ws(s.status)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Rs(s.location,s.roomCode),s.userName&&e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:s.userName})]}),a&&t&&e.jsxs(w,{size:"sm",className:"ml-2 bg-institutional hover:bg-institutional/90",onClick:()=>t(s.id),children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),"Enviar"]})]})]})]}),s.status===g.CONNECTING&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-pulse"}),"Conectando..."]}),s.location===_.NETWORK&&e.jsx("div",{className:"mt-3 text-xs text-muted-foreground",children:"💡 Invita a este dispositivo a tu sala para transferencias más rápidas"})]})})}var J="Progress",Q=100,[Ss,wt]=Ie(J),[ks,As]=Ss(J),xe=u.forwardRef((s,t)=>{const{__scopeProgress:o,value:a=null,max:i,getValueLabel:l=Is,...y}=s;(i||i===0)&&!se(i)&&console.error(Ms(`${i}`,"Progress"));const p=se(i)?i:Q;a!==null&&!te(a,p)&&console.error(Os(`${a}`,"Progress"));const x=te(a,p)?a:null,T=$(x)?l(x,p):void 0;return e.jsx(ks,{scope:o,value:x,max:p,children:e.jsx(ne.div,{"aria-valuemax":p,"aria-valuemin":0,"aria-valuenow":$(x)?x:void 0,"aria-valuetext":T,role:"progressbar","data-state":ve(x,p),"data-value":x??void 0,"data-max":p,...y,ref:t})})});xe.displayName=J;var fe="ProgressIndicator",ge=u.forwardRef((s,t)=>{const{__scopeProgress:o,...a}=s,i=As(fe,o);return e.jsx(ne.div,{"data-state":ve(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...a,ref:t})});ge.displayName=fe;function Is(s,t){return`${Math.round(s/t*100)}%`}function ve(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function $(s){return typeof s=="number"}function se(s){return $(s)&&!isNaN(s)&&s>0}function te(s,t){return $(s)&&!isNaN(s)&&s<=t&&s>=0}function Ms(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Q}\`.`}function Os(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Q} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ne=xe,Ps=ge;const V=u.forwardRef(({className:s,value:t,...o},a)=>e.jsx(Ne,{ref:a,className:Ae("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...o,children:e.jsx(Ps,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));V.displayName=Ne.displayName;const Ls=s=>{switch(s){case v.COMPLETED:return"default";case v.UPLOADING:case v.DOWNLOADING:return"secondary";case v.FAILED:return"destructive";default:return"outline"}};function Us({transfer:s,onCancel:t,onRetry:o}){const a=s.status===v.UPLOADING||s.status===v.DOWNLOADING,i=s.status===v.FAILED,l=a||s.status===v.PENDING;return e.jsx(re,{className:"glass-card border-white/30 bg-white/60 hover:bg-white/80 dark:bg-slate-800/60 dark:hover:bg-slate-800/80 transition-all",children:e.jsxs(oe,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:s.fileName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:P(s.fileSize)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:Ls(s.status),className:"text-xs",children:Es(s.status)}),i&&e.jsx(w,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>o?.(s.id),children:e.jsx(ls,{className:"w-3 h-3"})}),l&&e.jsx(w,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>t?.(s.id),children:e.jsx(W,{className:"w-3 h-3"})})]})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx(V,{value:s.progress,className:"mb-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.progress,"%"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("span",{children:ys(s.speed)}),e.jsxs("span",{children:[Cs(s.remainingTime)," restante"]})]})]})]}),s.status===v.COMPLETED&&e.jsx(V,{value:100,className:"mb-2"})]})})}function zs({roomCode:s,className:t}){const[o,a]=u.useState(!1),i=async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(s),a(!0),setTimeout(()=>a(!1),2e3);return}const l=document.createElement("textarea");l.value=s,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();const y=document.execCommand("copy");if(document.body.removeChild(l),y)a(!0),setTimeout(()=>a(!1),2e3);else throw new Error("Copy command failed")}catch(l){console.error("Failed to copy room code:",l),alert(`Código de sala: ${s}

No se pudo copiar automáticamente. Por favor, copia manualmente.`)}};return e.jsxs("div",{className:`flex items-center gap-2 ${t}`,children:[e.jsx(M,{variant:"outline",className:"font-mono text-sm px-3 py-1",children:s}),e.jsx(Le,{children:e.jsxs(Ue,{children:[e.jsx(ze,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:i,children:o?e.jsx(ue,{className:"w-4 h-4 text-green-600"}):e.jsx(_e,{className:"w-4 h-4"})})}),e.jsx($e,{children:e.jsx("p",{children:o?"¡Copiado!":"Copiar código de sala"})})]})})]})}function $s({username:s,roomCode:t,onUsernameChange:o,onGenerateNewUsername:a,onJoinRoom:i}){const[l,y]=u.useState(!1),[p,x]=u.useState(s),[T,d]=u.useState(!1),[m,k]=u.useState(""),R=()=>{p.trim()&&(o(p.trim()),y(!1))},A=()=>{x(s),y(!1)},E=()=>{m.trim()&&i&&(i(m.trim().toUpperCase()),k(""),d(!1))};return e.jsxs(O,{title:"Perfil de Usuario",description:"Tu información de sesión",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"username",children:"Nombre de Usuario"}),e.jsx("div",{className:"flex items-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(ee,{id:"username",value:p,onChange:j=>x(j.target.value),className:"flex-1",onKeyDown:j=>{j.key==="Enter"&&R(),j.key==="Escape"&&A()}}),e.jsx(w,{size:"sm",variant:"ghost",onClick:R,children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx(w,{size:"sm",variant:"ghost",onClick:A,children:e.jsx(W,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 px-3 py-2 bg-muted rounded-md text-sm",children:s}),e.jsx(w,{size:"sm",variant:"ghost",onClick:()=>y(!0),children:e.jsx(is,{className:"w-4 h-4"})})]})}),e.jsx(w,{variant:"outline",size:"sm",onClick:a,className:"text-xs border-institutional text-institutional hover:bg-institutional/10",children:"Generar Usuario Aleatorio"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Código de Sala"}),e.jsx(zs,{roomCode:t}),i&&e.jsxs(ce,{open:T,onOpenChange:d,children:[e.jsx(Me,{asChild:!0,children:e.jsxs(w,{size:"sm",className:"w-full bg-institutional hover:bg-institutional/90",children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),"Unirse a Sala"]})}),e.jsxs(le,{children:[e.jsx(de,{children:e.jsx(me,{children:"Unirse a Sala Privada"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"join-room-code",children:"Código de Sala"}),e.jsx(ee,{id:"join-room-code",placeholder:"Ej: ABCD-1234",value:m,onChange:j=>k(j.target.value),className:"uppercase",onKeyDown:j=>{j.key==="Enter"&&E()}})]}),e.jsx(w,{onClick:E,className:"w-full bg-institutional hover:bg-institutional/90",disabled:!m.trim(),children:"Unirse a Sala"})]})]})]})]})]})}function _s({onFileSelect:s,maxFileSize:t=100*1024*1024,className:o}){const[a,i]=u.useState(!1),l=u.useRef(null),y=m=>{m.preventDefault(),i(!0)},p=m=>{m.preventDefault(),i(!1)},x=m=>{m.preventDefault(),i(!1);const R=Array.from(m.dataTransfer.files).filter(A=>A.size<=t);R.length>0&&s(R)},T=m=>{const R=Array.from(m.target.files||[]).filter(A=>A.size<=t);R.length>0&&s(R),l.current&&(l.current.value="")},d=()=>{l.current?.click()};return e.jsx("div",{className:`border-2 border-dashed rounded-lg transition-all ${a?"border-institutional bg-institutional/5":"border-gray-300 dark:border-gray-700"}`,onDragOver:y,onDragLeave:p,onDrop:x,children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center space-y-4",children:[e.jsx("div",{className:`p-4 rounded-full transition-colors ${a?"bg-institutional/10":"bg-muted"}`,children:a?e.jsx(ie,{className:"w-8 h-8 text-institutional"}):e.jsx(he,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium text-lg text-slate-900 dark:text-white",children:a?"Suelta los archivos aquí":"Arrastra archivos aquí para compartir"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"O haz clic para explorar archivos"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Límite de tamaño: ",Math.round(t/(1024*1024)),"MB"]})]}),e.jsx(w,{onClick:d,className:"bg-institutional hover:bg-institutional/90",children:"Explorar Archivos"}),e.jsx("input",{ref:l,type:"file",multiple:!0,className:"hidden",onChange:T})]})})})}function qs({queuedFiles:s,devices:t,onSendFile:o,onRemoveFile:a}){const[i,l]=u.useState({}),y=(d,m)=>{l(k=>({...k,[d]:m}))},p=d=>{const m=i[d];m&&o(d,m)},x=d=>{switch(d){case"queued":return"default";case"sending":return"secondary";case"sent":return"outline";default:return"default"}},T=d=>{switch(d){case"queued":return"En Cola";case"sending":return"Enviando";case"sent":return"Enviado";default:return"Desconocido"}};return s.length===0?e.jsx(O,{title:"Cola de Archivos (0)",description:"Archivos listos para enviar",children:e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"font-medium text-slate-900 dark:text-white mb-1",children:"No hay archivos en cola"}),e.jsx("p",{className:"text-sm",children:"Selecciona archivos para agregarlos a la cola"})]})}):e.jsx(O,{title:`Cola de Archivos (${s.length})`,description:"Archivos listos para enviar",children:e.jsx("div",{className:"space-y-4",children:s.map(d=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg glass-card border-white/30 bg-white/60 dark:bg-slate-800/60",children:[e.jsx(B,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:d.file.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:P(d.file.size)})]}),e.jsx(M,{variant:x(d.status),className:"text-xs",children:T(d.status)}),d.status==="queued"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(qe,{value:i[d.id]||"",onValueChange:m=>y(d.id,m),children:[e.jsx(Fe,{className:"w-32",children:e.jsx(Ge,{placeholder:"Destino"})}),e.jsx(He,{children:t.map(m=>e.jsx(Be,{value:m.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:m.name}),m.userName&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",m.userName,")"]})]})},m.id))})]}),e.jsx(w,{size:"sm",className:"bg-institutional hover:bg-institutional/90",onClick:()=>p(d.id),disabled:!i[d.id],children:e.jsx(pe,{className:"w-4 h-4"})})]}),d.status==="sending"&&e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(Ye,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-xs",children:"Enviando..."})]}),d.status==="sent"&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Esperando respuesta"})]}),e.jsx(w,{size:"sm",variant:"ghost",onClick:()=>a(d.id),disabled:d.status==="sending",children:e.jsx(W,{className:"w-4 h-4"})})]},d.id))})})}function Fs({request:s,isOpen:t,onClose:o,onAccept:a,onReject:i}){const[l,y]=u.useState(!1),[p,x]=u.useState(!1);if(!s)return null;const T=async()=>{y(!0);try{await a(s.id)}finally{y(!1),o()}},d=async()=>{x(!0);try{await i(s.id)}finally{x(!1),o()}},m=()=>{const k=new Date,R=new Date(s.requestedAt),A=k.getTime()-R.getTime(),E=Math.floor(A/6e4);if(E<1)return"Hace un momento";if(E===1)return"Hace 1 minuto";if(E<60)return`Hace ${E} minutos`;const j=Math.floor(E/60);return j===1?"Hace 1 hora":`Hace ${j} horas`};return e.jsx(ce,{open:t,onOpenChange:o,children:e.jsxs(le,{className:"sm:max-w-md",children:[e.jsxs(de,{children:[e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-primary"}),"Solicitud de Transferencia"]}),e.jsx(Oe,{children:"Alguien quiere enviarte un archivo"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-lg",children:[e.jsx(B,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.fileName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:P(s.fileSize)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ps,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["De: ",s.fromUserName]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(H,{className:"w-3 h-3"}),m()]})]})]}),s.fileSize>100*1024*1024&&e.jsxs(Ve,{children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsxs(We,{children:["Este archivo es grande (",P(s.fileSize),"). La transferencia puede tomar varios minutos."]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(M,{variant:"secondary",className:"gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),"Esperando tu respuesta"]})})]}),e.jsxs(Pe,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(w,{variant:"outline",onClick:d,disabled:l||p,className:"flex-1",children:p?"Rechazando...":"Rechazar"}),e.jsx(w,{onClick:T,disabled:l||p,className:"flex-1 bg-institutional hover:bg-institutional/90",children:l?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2 animate-pulse"}),"Aceptando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Aceptar y Descargar"]})})]})]})})}D.defaults.baseURL="/api";D.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const ae=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");ae&&(D.defaults.headers.common["X-CSRF-TOKEN"]=ae);class C{static async createRoom(t,o,a){try{return(await D.post("/room/create",{deviceName:t,deviceType:o,userName:a})).data}catch(i){throw console.error("Error creating room:",i),i}}static async joinRoom(t,o,a,i){try{return(await D.post("/room/join",{roomCode:t,deviceName:o,deviceType:a,userName:i})).data}catch(l){throw console.error("Error joining room:",l),l}}static async leaveRoom(){try{return(await D.post("/room/leave")).data}catch(t){throw console.error("Error leaving room:",t),t}}static async getRoomDevices(t){try{return(await D.get(`/room/${t}/devices`)).data}catch(o){throw console.error("Error getting room devices:",o),o}}static async requestTransfer(t,o){try{const a=new FormData;return a.append("targetDeviceId",t),a.append("fileName",o.name),a.append("fileSize",o.size.toString()),a.append("file",o),(await D.post("/transfer/request",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("Error requesting transfer:",a),a}}static async getPendingRequests(){try{return(await D.get("/transfer/pending")).data}catch(t){throw console.error("Error getting pending requests:",t),t}}static async respondToTransfer(t,o){try{return(await D.post(`/transfer/${t}/respond`,{action:o})).data}catch(a){throw console.error("Error responding to transfer:",a),a}}static async getTransferStatus(t){try{return(await D.get(`/transfer/${t}/status`)).data}catch(o){throw console.error("Error getting transfer status:",o),o}}static async downloadFile(t){try{return(await D.get(`/transfer/${t}/download`,{responseType:"blob"})).data}catch(o){throw console.error("Error downloading file:",o),o}}static async healthCheck(){try{return(await D.get("/health")).data}catch(t){throw console.error("Error checking API health:",t),t}}static detectDeviceType(){const t=navigator.userAgent.toLowerCase();return/mobile|android|iphone|ipod|blackberry|windows phone/.test(t)?"mobile":/ipad|tablet/.test(t)?"tablet":(/macintosh|mac os x/.test(t)&&"ontouchstart"in window,"laptop")}static detectDeviceName(){const t=navigator.userAgent;return/Macintosh/.test(t)?"MacBook":/Windows/.test(t)?"PC Windows":/iPhone/.test(t)?"iPhone":/iPad/.test(t)?"iPad":/Android/.test(t)?/Mobile/.test(t)?"Android Phone":"Android Tablet":"Dispositivo"}}function Gs({appName:s,maxFileSize:t,networkName:o}){const[a,i]=u.useState({id:"",username:"",roomCode:"",isInRoom:!1,deviceName:"",deviceType:"laptop"}),[l,y]=u.useState([]),[p,x]=u.useState([]),[T,d]=u.useState(g.DISCONNECTED),[m,k]=u.useState(!1),[R,A]=u.useState(""),[E,j]=u.useState([]),[Hs,Bs]=u.useState([]),[S,L]=u.useState(null),[U,z]=u.useState(!1),[Vs,I]=u.useState(null),K=r=>{i(n=>({...n,username:r}))};u.useEffect(()=>{const r=C.detectDeviceType(),n=C.detectDeviceName(),c=X();i(f=>({...f,username:c,deviceName:n,deviceType:r}))},[]),u.useEffect(()=>{a.username&&!a.isInRoom&&!U&&(console.log("🚀 Auto-creating room on page load for:",a.username),Ce())},[a.username,a.isInRoom,U]),u.useEffect(()=>{if(!a.isInRoom||!a.roomCode)return;const r=async()=>{try{const c=await C.getRoomDevices(a.roomCode),h=(c.devices||[]).filter(N=>N.id!==c.currentDeviceId).map(N=>({id:N.id,name:N.name,type:N.type,status:g.CONNECTED,lastSeen:N.lastSeen,location:_.SAME_ROOM,roomCode:a.roomCode,userName:N.userName}));y(h),d(g.CONNECTED)}catch(c){console.error("Error polling devices:",c),I("Error al obtener dispositivos")}};r();const n=setInterval(r,3e3);return()=>clearInterval(n)},[a.isInRoom,a.roomCode]),u.useEffect(()=>{if(!a.isInRoom)return;const n=setInterval(async()=>{try{const f=(await C.getPendingRequests()).requests||[];if(f.length>0&&!S){const h=f[0],N={id:h.id,fileName:h.fileName,fileSize:h.fileSize,fromDevice:"unknown",fromUserName:h.fromUserName,requestedAt:h.requestedAt,status:"pending"};L(N)}}catch(c){console.error("Error polling requests:",c)}},2e3);return()=>clearInterval(n)},[a.isInRoom,S]);const X=()=>{const r=["Azul","Rápido","Brillante","Veloz","Inteligente","Genial","Ágil","Verde","Mágico","Estelar","Dorado","Plateado","Cristal","Solar","Lunar","Cyber","Neo","Ultra","Mega","Super","Turbo","Quantum"],n=["Caminante","Explorador","Navegante","Pionero","Guardián","Viajero","Aventurero","Descobridor","Ingeniero","Arquitecto","Desarrollador","Creador","Innovador","Maestro","Experto","Líder","Campeón","Héroe"],c=Math.floor(Math.random()*9999)+1,f=r[Math.floor(Math.random()*r.length)],h=n[Math.floor(Math.random()*n.length)];return`${f}${h}${c}`},je=()=>{const r=X();K(r)},ye=()=>{const r="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let n="";for(let c=0;c<4;c++)n+=r.charAt(Math.floor(Math.random()*r.length));n+="-";for(let c=0;c<4;c++)n+=r.charAt(Math.floor(Math.random()*r.length));return n},Ce=async()=>{if(!U){z(!0),I(null);try{console.log("🚀 Creating room with:",{deviceName:a.deviceName||C.detectDeviceName(),deviceType:a.deviceType||C.detectDeviceType(),username:a.username});const r=await C.createRoom(a.deviceName||C.detectDeviceName(),a.deviceType||C.detectDeviceType(),a.username);console.log("✅ Room created response:",r),i(n=>({...n,id:r.device.id,roomCode:r.roomCode,isInRoom:!0})),d(g.CONNECTED),console.log("🎯 Room code set:",r.roomCode)}catch(r){console.error("❌ Error creating room:",r);const n=ye();console.log("🔄 Using fallback room code:",n),i(c=>({...c,id:`local-${Date.now()}`,roomCode:n,isInRoom:!0})),d(g.CONNECTED),I("Usando modo local. Otros dispositivos pueden unirse con el código mostrado.")}finally{z(!1)}}},we=async r=>{if(!U){z(!0),I(null),d(g.CONNECTING);try{console.log("🚀 Joining room with code:",r);const n=await C.joinRoom(r,a.deviceName||C.detectDeviceName(),a.deviceType||C.detectDeviceType(),a.username);console.log("✅ Room joined response:",n),i(c=>({...c,id:n.device.id,roomCode:n.roomCode,isInRoom:!0})),d(g.CONNECTED),console.log("🎯 Successfully joined room:",n.roomCode)}catch(n){console.error("❌ Error joining room:",n),I("No se pudo unir a la sala. Verifica el código e intenta nuevamente."),d(g.DISCONNECTED)}finally{z(!1)}}},Ee=r=>{r.forEach(n=>{const c={id:`queued-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,file:n,status:"queued",addedAt:new Date().toISOString()};j(f=>[...f,c])})},Z=async(r,n)=>{const c=E.find(f=>f.id===r);if(c){j(f=>f.map(h=>h.id===r?{...h,status:"sending",targetDeviceId:n}:h));try{const f=await C.requestTransfer(n,c.file);j(h=>h.map(N=>N.id===r?{...N,status:"sent",transferId:f.transferId}:N))}catch(f){console.error("Error sending file:",f),I("Error al enviar archivo. Inténtalo de nuevo."),j(h=>h.map(N=>N.id===r?{...N,status:"queued",targetDeviceId:void 0}:N))}}},De=r=>{j(n=>n.filter(c=>c.id!==r))},be=async r=>{if(S)try{await C.respondToTransfer(r,"accept");const n={id:r,fileName:S.fileName,fileSize:S.fileSize,status:v.UPLOADING,progress:0,speed:1024e3,remainingTime:Math.ceil(S.fileSize/1024e3),fromDevice:S.fromDevice,toDevice:a.id,acceptedAt:new Date().toISOString()};x(c=>[...c,n]),L(null),setTimeout(async()=>{try{const c=await C.downloadFile(r),f=window.URL.createObjectURL(c),h=document.createElement("a");h.href=f,h.download=S.fileName,document.body.appendChild(h),h.click(),window.URL.revokeObjectURL(f),document.body.removeChild(h),x(N=>N.map(q=>q.id===r?{...q,status:v.COMPLETED,progress:100,remainingTime:0,completedAt:new Date().toISOString()}:q))}catch(c){console.error("Error downloading file:",c),x(f=>f.map(h=>h.id===r?{...h,status:v.FAILED}:h))}},1e3)}catch(n){console.error("Error accepting transfer:",n),I("Error al aceptar transferencia")}},Re=async r=>{try{await C.respondToTransfer(r,"reject"),L(null)}catch(n){console.error("Error rejecting transfer:",n),I("Error al rechazar transferencia")}},Te=r=>{x(n=>n.map(c=>c.id===r?{...c,status:v.CANCELLED}:c))};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{"data-tour":"devices",children:e.jsx(O,{title:`Dispositivos Disponibles (${l.length})`,description:"Dispositivos conectados en tu sala",children:l.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(vs,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"font-medium text-slate-900 dark:text-white mb-2",children:"No hay dispositivos en la sala"}),e.jsx("p",{className:"text-sm",children:a.isInRoom?"Esperando conexiones...":"Únete o crea una sala para comenzar"})]}):e.jsx("div",{className:"space-y-3",children:l.map(r=>e.jsx(Ts,{device:r,hasQueuedFiles:E.length>0,onSendFiles:()=>{const n=E.find(c=>c.status==="queued");n&&Z(n.id,r.id)}},r.id))})})}),e.jsx("div",{"data-tour":"transfer-zone",children:e.jsx(O,{title:"Zona de Transferencia",description:"Arrastra archivos aquí para compartir",children:a.isInRoom&&l.length>0?e.jsx(_s,{onFileSelect:Ee,maxFileSize:t}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(he,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"font-medium text-slate-900 dark:text-white mb-2",children:"Zona de Transferencia"}),e.jsx("p",{className:"text-sm mb-3",children:"Para transferir archivos necesitas:"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{children:"✓ Estar en una sala activa"}),e.jsx("p",{children:"✓ Tener dispositivos conectados"})]})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{"data-tour":"user-profile",children:e.jsx($s,{username:a.username,roomCode:a.roomCode,onUsernameChange:K,onGenerateNewUsername:je,onJoinRoom:we})}),E.length>0&&e.jsx("div",{"data-tour":"file-queue",children:e.jsx(qs,{queuedFiles:E,devices:l.filter(r=>r.status===g.CONNECTED),onSendFile:Z,onRemoveFile:De})}),p.length>0&&e.jsx(O,{title:"Transferencias Activas",description:"Archivos en proceso de transferencia",children:e.jsx("div",{className:"space-y-3",children:p.map(r=>e.jsx(Us,{transfer:r,onCancel:()=>Te(r.id)},r.id))})})]})]}),e.jsx(Fs,{request:S,isOpen:S!==null,onClose:()=>L(null),onAccept:be,onReject:Re})]})}function Et(){const s=()=>{Ke({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="user-profile"]',popover:{title:"Paso 1: Tu Perfil",description:"Aquí puedes ver y editar tu nombre de usuario. También se muestra el código de tu sala actual. ¡Puedes generar un nuevo usuario aleatorio si lo deseas!",side:"left",align:"start"}},{element:'[data-tour="devices"]',popover:{title:"Paso 2: Dispositivos Disponibles",description:"Una vez que crees o te unas a una sala, verás aquí todos los dispositivos conectados. Podrás enviarles archivos con solo un clic.",side:"right",align:"start"}},{element:'[data-tour="transfer-zone"]',popover:{title:"Paso 3: Zona de Transferencia",description:"Arrastra archivos aquí o haz clic para seleccionarlos. Los archivos se añadirán a la cola y podrás enviarlos a cualquier dispositivo conectado.",side:"right",align:"start"}},{element:'[data-tour="file-queue"]',popover:{title:"Paso 4: Cola de Archivos",description:"Aquí verás los archivos que has seleccionado y están listos para enviar. Podrás elegir a qué dispositivo enviar cada archivo.",side:"left",align:"start"}}]}).drive()};return e.jsxs(e.Fragment,{children:[e.jsx(Se,{title:"Evarisdrop - Evaristools",children:e.jsx("meta",{name:"description",content:"Sistema de transferencia de archivos entre dispositivos en tiempo real"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(ke,{title:"Evarisdrop",description:"Transferencia de archivos entre dispositivos en tiempo real",icon:Xe,showPopularBadge:!0}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"max-w-6xl mx-auto mb-4",children:e.jsxs(w,{onClick:s,variant:"outline",size:"sm",className:"flex items-center gap-2 border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(Qe,{className:"w-4 h-4"}),"¿Cómo usar Evarisdrop?"]})}),e.jsx(Gs,{appName:"Evarisdrop",maxFileSize:52428800,networkName:"Evaristools Network"})]})]})]})}export{Et as default};
