import{r as i,j as e,H as E,a as w}from"./app-BUl2XNVK.js";import{B as n}from"./createLucideIcon-nQgsIK04.js";import{T as y,a as l}from"./ToolCard-DUmtgb5y.js";import{F as k}from"./FileUploadZone-Dme-ExYg.js";import{C as T,A as P}from"./driver-TOg9fbSz.js";import{F as g}from"./file-down-B9zX4R8P.js";import{C as D}from"./circle-alert-DVH5G-gN.js";import{F as S}from"./file-text-CLErbyE6.js";import{C as B}from"./circle-check-big-D3LO5hBg.js";import{U as j}from"./upload-BNlRWnz8.js";import{L as A}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./badge-ClX4IzPs.js";import"./arrow-left-C3I9wMLH.js";import"./building-2-DsJ5nUpW.js";function Q(){const[t,m]=i.useState(null),[c,x]=i.useState(!1),[b,d]=i.useState(!1),[p,a]=i.useState(""),[O,R]=i.useState(!1),N=i.useRef(null),C=()=>{P({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="left-column"]',popover:{title:"Paso 1: Seleccionar Excel",description:"Arrastra tu archivo Excel (.xls o .xlsx) aquí o haz clic para seleccionarlo. Tamaño máximo: 25MB.",side:"right",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 2: Convertir a PDF",description:'Una vez cargado tu archivo Excel, haz clic en "Convertir a PDF" para iniciar la conversión. El archivo se descargará automáticamente.',side:"left",align:"start"}}]}).drive()},u=s=>{const r=s[0];if(!r)return;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(r.type)){a("Por favor selecciona un archivo Excel válido (.xls o .xlsx).");return}if(r.size>25*1024*1024){a("El archivo es demasiado grande. Máximo 25MB permitido.");return}m(r),a(""),d(!1)},F=async()=>{if(t){x(!0),a("");try{const s=new FormData;s.append("file",t);const r=await w.post("/tools/excel-to-pdf/convert",s,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},responseType:"blob",timeout:12e4}),f=new Blob([r.data],{type:"application/pdf"}),v=window.URL.createObjectURL(f),o=document.createElement("a");o.href=v,o.download=`${t.name.replace(/\.(xlsx?|xls)$/i,"")}_converted.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(v),d(!0)}catch(s){console.error("Error converting to PDF:",s);let r="Error al convertir el documento.";s.response?.status===404?r="La conversión de Excel a PDF requiere configuración adicional en el servidor. Contacta al administrador del sistema.":s.response?.status===500?r="Error en el servidor al procesar el archivo. Verifica que el archivo no esté corrupto.":s.code==="ECONNABORTED"&&(r="La conversión está tardando demasiado. Intenta con un archivo más pequeño."),a(r)}finally{x(!1)}}},h=()=>{m(null),d(!1),a("")};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Excel a PDF - Evaristools"}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(y,{title:"Excel a PDF",description:"Convierte hojas de cálculo Excel a formato PDF",icon:g}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6","data-tour":"left-column",children:[!t&&e.jsxs(l,{title:"Seleccionar Excel",children:[e.jsx(k,{onFileSelect:u,acceptedTypes:".xls,.xlsx",title:"Arrastra tu hoja de cálculo aquí",subtitle:"o haz clic para seleccionar (máximo 25MB)"}),e.jsx("input",{ref:N,type:"file",accept:".xls,.xlsx",onChange:s=>s.target.files&&u(s.target.files),className:"hidden"})]}),p&&e.jsx(l,{title:"Error",children:e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(D,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-red-800 dark:text-red-200",children:p})]})}),t&&e.jsx(l,{title:"Archivo Seleccionado",children:e.jsx("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{className:"h-8 w-8 text-institutional"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]})})}),b&&e.jsx(l,{title:"¡Conversión Exitosa!",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(B,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:"¡PDF generado y descargado exitosamente!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"El archivo se ha guardado en tu carpeta de descargas."})]})]}),e.jsxs(n,{onClick:h,variant:"outline",className:"w-full",children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Convertir Otro Archivo"]})]})})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(l,{title:"Acciones","data-tour":"actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(n,{onClick:F,disabled:c||!t,className:"flex-1 bg-institutional hover:bg-institutional/90",children:c?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Convirtiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Convertir a PDF"]})}),e.jsxs(n,{onClick:h,variant:"outline",className:"flex-1",disabled:c,children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Seleccionar Otro"]})]}),e.jsxs(n,{onClick:C,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})})})]})})})]})]})}export{Q as default};
