import{r as t,j as e,H as B,a as R}from"./app-CPNA5fkj.js";import{B as c}from"./createLucideIcon-CNZUbRUR.js";import{I as N}from"./input-CaIiDfhq.js";import{L as F}from"./label-Df9ZlVEi.js";import{T as I,a as n}from"./ToolCard-DvrNwqcD.js";import{F as q}from"./FileUploadZone-Bf4dPOuB.js";import{C as M,A as z}from"./driver-XYzfMZAG.js";import{L as y}from"./lock-Bvxy0J_x.js";import{C as H}from"./circle-alert-Z29hfl0A.js";import{F as _}from"./file-text-B0fBpE6E.js";import{C as K}from"./circle-check-big-CW96IzkE.js";import{U as C}from"./upload-B_bVGoQi.js";import{E as k}from"./eye-off-DbvGKPT6.js";import{E as D}from"./eye-BQVjxIxA.js";import{L as X}from"./loader-circle-Brj18nMe.js";import"./app-Cr7akxs5.js";import"./index-CRnDzTJV.js";import"./badge-kZYjAK_4.js";import"./arrow-left-DbcVuJzq.js";import"./building-2-DNyTMdoQ.js";function pe(){const[o,u]=t.useState(null),[i,h]=t.useState(""),[f,g]=t.useState(""),[d,S]=t.useState(!1),[m,E]=t.useState(!1),[p,j]=t.useState(!1),[T,x]=t.useState(!1),[w,a]=t.useState(""),L=t.useRef(null),O=()=>{z({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Subir PDF",description:"Selecciona el archivo PDF que deseas proteger con contraseña.",side:"right",align:"start"}},{element:'[data-tour="password"]',popover:{title:"Paso 2: Crear Contraseña",description:"Ingresa y confirma una contraseña segura. Asegúrate de recordarla, ya que la necesitarás para abrir el PDF.",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Proteger PDF",description:'Haz clic en "Proteger PDF" para aplicar la contraseña. El archivo protegido se descargará automáticamente.',side:"left",align:"start"}}]}).drive()},v=s=>{const r=s[0];if(r){if(r.type!=="application/pdf"){a("Por favor selecciona un archivo PDF válido.");return}if(r.size>50*1024*1024){a("El archivo es demasiado grande. Máximo 50MB permitido.");return}u(r),a(""),x(!1)}},A=async()=>{if(!o||!i){a("Por favor ingresa al menos la contraseña de usuario.");return}if(i.length<4){a("La contraseña debe tener al menos 4 caracteres.");return}j(!0),a("");try{const s=new FormData;s.append("pdf",o),s.append("user_password",i),s.append("owner_password",f||i);const r=await R.post("/tools/protect-pdf/protect",s,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},responseType:"blob",timeout:12e4}),U=new Blob([r.data],{type:"application/pdf"}),b=window.URL.createObjectURL(U),l=document.createElement("a");l.href=b,l.download=`${o.name.replace(".pdf","")}_protegido.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(b),x(!0)}catch(s){console.error("Error protecting PDF:",s);let r="Error al proteger el documento.";s.response?.status===404?r="La función de protección de PDF requiere configuración adicional.":s.response?.data?.error&&(r=s.response.data.error),a(r)}finally{j(!1)}},P=()=>{u(null),h(""),g(""),x(!1),a("")};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Proteger PDF - Evaristools"}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(I,{title:"Proteger PDF",description:"Añade protección por contraseña a tus documentos PDF",icon:y}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6","data-tour":"upload",children:[!o&&e.jsxs(n,{title:"Seleccionar PDF",children:[e.jsx(q,{onFileSelect:v,acceptedTypes:".pdf",title:"Arrastra tu PDF aquí",subtitle:"o haz clic para seleccionar (máximo 50MB)"}),e.jsx("input",{ref:L,type:"file",accept:".pdf",onChange:s=>s.target.files&&v(s.target.files),className:"hidden"})]}),w&&e.jsx(n,{title:"Error",children:e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(H,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-red-800 dark:text-red-200",children:w})]})}),o&&e.jsx(n,{title:"Archivo Seleccionado",children:e.jsx("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"h-8 w-8 text-institutional"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:o.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[(o.size/1024/1024).toFixed(2)," MB"]})]})]})})}),T&&e.jsx(n,{title:"¡PDF Protegido Exitosamente!",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(K,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:"¡El PDF está protegido y descargado!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"Ahora el documento requiere contraseña para abrirse."})]})]}),e.jsxs(c,{onClick:P,variant:"outline",className:"w-full",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Proteger Otro PDF"]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{title:"Configurar Contraseña","data-tour":"password",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"user-password",children:"Contraseña de Usuario *"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(N,{id:"user-password",type:d?"text":"password",value:i,onChange:s=>h(s.target.value),placeholder:"Mínimo 4 caracteres"}),e.jsx("button",{type:"button",onClick:()=>S(!d),className:"absolute right-3 top-1/2 -translate-y-1/2",children:d?e.jsx(k,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(F,{htmlFor:"owner-password",children:"Contraseña de Propietario (Opcional)"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(N,{id:"owner-password",type:m?"text":"password",value:f,onChange:s=>g(s.target.value),placeholder:"Deja vacío para usar la misma"}),e.jsx("button",{type:"button",onClick:()=>E(!m),className:"absolute right-3 top-1/2 -translate-y-1/2",children:m?e.jsx(k,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"})})]})]})]})}),e.jsxs(n,{title:"Acciones","data-tour":"actions",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(c,{onClick:A,disabled:p||!i,className:"flex-1 bg-institutional hover:bg-institutional/90",children:p?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-2 h-4 w-4 animate-spin"}),"Protegiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Proteger PDF"]})}),e.jsxs(c,{onClick:P,variant:"outline",className:"flex-1",disabled:p,children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Seleccionar Otro"]})]}),e.jsxs(c,{onClick:O,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})]})]})})})]})]})}export{pe as default};
