import{r as d,j as e,H as ne,L as ie}from"./app-BUl2XNVK.js";import{a as O,B as m}from"./createLucideIcon-nQgsIK04.js";import{B as I,C as w,a as k,b as D,c as F,d as C}from"./badge-ClX4IzPs.js";import{L as E}from"./label-B-7Te5tz.js";import{P as B}from"./PDFButton-hZ4qujXN.js";import{C as oe,A as le}from"./driver-TOg9fbSz.js";import{A as ce}from"./arrow-left-C3I9wMLH.js";import{F as v}from"./file-up-D3jVo1P-.js";import{B as de}from"./building-2-DsJ5nUpW.js";import{U as me}from"./upload-BNlRWnz8.js";import{T as he}from"./trash-2-Eh1zItU7.js";import{X as xe}from"./x-LZ7JQ_06.js";import{L as pe}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./index-C9DtIOMg.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ge=O("GripVertical",ue);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],je=O("Plus",fe);function Te(){const[t,u]=d.useState([]),[S,z]=d.useState(!1),[ve,g]=d.useState(0),[R,h]=d.useState(""),[l,y]=d.useState({preserveBookmarks:!0,preserveMetadata:!0,addPageNumbers:!1}),A=d.useRef(null),_=d.useRef(null),x=d.useRef(null),H=()=>{le({showProgress:!0,popoverClass:"driverjs-theme",prevBtnText:"Anterior",nextBtnText:"Siguiente",doneBtnText:"Finalizar",steps:[{element:'[data-tour="upload"]',popover:{title:"Paso 1: Agregar PDFs",description:'Arrastra múltiples archivos PDF aquí o usa el botón "Agregar PDFs". Puedes añadir tantos archivos como necesites y reordenarlos.',side:"right",align:"start"}},{element:'[data-tour="options"]',popover:{title:"Paso 2: Configurar Opciones",description:"Elige si deseas preservar marcadores y metadatos, o agregar números de página al PDF combinado.",side:"left",align:"start"}},{element:'[data-tour="actions"]',popover:{title:"Paso 3: Unir PDFs",description:'Una vez agregados al menos 2 archivos PDF, haz clic en "Unir PDFs" para combinarlos en un solo documento.',side:"left",align:"start"}}]}).drive()},V=()=>Math.random().toString(36).substr(2,9),M=async s=>{const a=[];for(let n=0;n<s.length;n++){const r=s[n];if(r.type!=="application/pdf"){alert(`"${r.name}" no es un archivo PDF válido. Solo se permiten archivos PDF.`);continue}if(t.some(o=>o.name===r.name&&o.size===r.size)){alert(`"${r.name}" ya está en la lista.`);continue}try{const o=await r.arrayBuffer(),i=(await B.load(o)).getPageCount();a.push({id:V(),file:r,name:r.name,size:r.size,pages:i})}catch(o){console.error(`Error loading PDF "${r.name}":`,o),alert(`Error al cargar "${r.name}". El archivo PDF podría estar dañado.`)}}a.length>0&&u(n=>[...n,...a])},G=s=>{s.preventDefault(),s.stopPropagation()},q=s=>{s.preventDefault(),s.stopPropagation()},K=s=>{s.preventDefault(),s.stopPropagation()},X=s=>{s.preventDefault(),s.stopPropagation();const a=s.dataTransfer.files;a.length>0&&M(a)},Z=s=>{u(a=>a.filter(n=>n.id!==s))},J=()=>{u([])},Q=(s,a)=>{x.current=a,s.dataTransfer.effectAllowed="move"},W=(s,a)=>{if(s.preventDefault(),x.current===null)return;const n=a;if(x.current===n)return;const r=[...t],N=r[x.current];r.splice(x.current,1),r.splice(n,0,N),u(r),x.current=n},Y=()=>{x.current=null},ee=s=>{if(s===0)return;const a=[...t];[a[s],a[s-1]]=[a[s-1],a[s]],u(a)},se=s=>{if(s===t.length-1)return;const a=[...t];[a[s],a[s+1]]=[a[s+1],a[s]],u(a)},ae=async()=>{if(t.length<2){alert("Necesitas al menos 2 archivos PDF para unir.");return}z(!0),g(0),h("Inicializando...");try{const s=await B.create();let a=0;t.forEach(i=>a+=i.pages||0);let n=0;for(let i=0;i<t.length;i++){const p=t[i];h(`Procesando ${p.name}... (${i+1}/${t.length})`);try{const j=await p.file.arrayBuffer(),c=await B.load(j),T=c.getPageIndices();if((await s.copyPages(c,T)).forEach(b=>{s.addPage(b),n++;const P=Math.round(n/a*90);g(P)}),i===0&&l.preserveMetadata){const b=c.getTitle(),P=c.getAuthor(),$=c.getSubject(),L=c.getCreator();b&&s.setTitle(b),P&&s.setAuthor(P),$&&s.setSubject($),L&&s.setCreator(`${L} - Merged by Evaristools`)}}catch(j){throw console.error(`Error processing ${p.name}:`,j),new Error(`Error al procesar "${p.name}". El archivo podría estar dañado.`)}}h("Finalizando PDF unificado..."),g(95),l.addPageNumbers&&s.getPages().forEach((p,j)=>{const{width:c,height:T}=p.getSize();p.drawText(`${j+1}`,{x:c-50,y:30,size:10})}),h("Generando descarga..."),g(98);const r=await s.save(),N=new Blob([r],{type:"application/pdf"}),o=URL.createObjectURL(N),f=document.createElement("a");f.href=o,f.download=`PDFs_Unidos_${new Date().getTime()}.pdf`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(o),g(100),h("¡PDF unificado creado exitosamente!")}catch(s){console.error("Error uniendo PDFs:",s),alert(`Error al unir PDFs: ${s instanceof Error?s.message:"Error desconocido"}`),h("Error en el procesamiento")}finally{setTimeout(()=>{z(!1),g(0),h("")},2e3)}},U=s=>{if(s===0)return"0 Bytes";const a=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,r)).toFixed(2))+" "+n[r]},te=()=>t.reduce((s,a)=>s+(a.pages||0),0),re=()=>t.reduce((s,a)=>s+a.size,0);return e.jsxs(e.Fragment,{children:[e.jsx(ne,{title:"Unir PDFs - Evaristools",children:e.jsx("meta",{name:"description",content:"Une múltiples archivos PDF en un solo documento - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-white/20 dark:bg-slate-800/80 dark:border-slate-700/20",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ie,{href:"/",children:e.jsxs(m,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Volver"})]})}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-institutional/10 text-institutional",children:e.jsx(v,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Unir PDFs"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Combina múltiples archivos PDF en un solo documento"})]})]}),e.jsxs(I,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx(de,{className:"h-3 w-3"}),e.jsx("span",{children:"HUV"})]})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{"data-tour":"upload",children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-5 w-5"}),e.jsx("span",{children:"Subir Archivos PDF"})]}),e.jsx(F,{children:"Selecciona múltiples archivos PDF para unir en un solo documento"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsx("div",{ref:_,className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${t.length>0?"border-institutional bg-institutional/5":"border-slate-300 hover:border-institutional"}`,onDragOver:G,onDragEnter:q,onDragLeave:K,onDrop:X,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(v,{className:"h-12 w-12 mx-auto text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Arrastra múltiples PDFs aquí"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Solo archivos PDF (máximo recomendado: 10 archivos)"})]})]})}),e.jsx("input",{ref:A,type:"file",accept:".pdf",multiple:!0,onChange:s=>{const a=s.target.files;a&&M(a)},className:"hidden"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:()=>A.current?.click(),variant:"outline",className:"flex-1",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Agregar PDFs"]}),t.length>0&&e.jsx(m,{onClick:J,variant:"outline",className:"px-4",children:e.jsx(he,{className:"h-4 w-4"})})]}),t.length>0&&e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Archivos"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:t.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Páginas"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:te()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Tamaño"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:U(re())})]})]})})]})]}),t.length>0&&e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:"Archivos Seleccionados"})]}),e.jsxs(I,{variant:"outline",children:[t.length," archivos"]})]}),e.jsx(F,{children:"Arrastra para reordenar. El orden determina cómo se unirán los PDFs."})]}),e.jsx(C,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map((s,a)=>e.jsxs("div",{draggable:!0,onDragStart:n=>Q(n,a),onDragOver:n=>W(n,a),onDragEnd:Y,className:"flex items-center space-x-3 p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 cursor-move",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 min-w-[20px]",children:a+1}),e.jsx(ge,{className:"h-4 w-4 text-slate-400"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-500",children:[s.pages," páginas • ",U(s.size)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>ee(a),disabled:a===0,className:"h-6 w-6 p-0",children:"↑"}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>se(a),disabled:a===t.length-1,className:"h-6 w-6 p-0",children:"↓"}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>Z(s.id),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:e.jsx(xe,{className:"h-3 w-3"})})]})]},s.id))})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(w,{"data-tour":"options",children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:"Opciones de Unión"})]}),e.jsx(F,{children:"Configura cómo se unirán los archivos PDF"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"bookmarks",children:"Preservar Marcadores"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Mantener los marcadores del primer PDF"})]}),e.jsx("input",{id:"bookmarks",type:"checkbox",checked:l.preserveBookmarks,onChange:s=>y({...l,preserveBookmarks:s.target.checked}),className:"h-4 w-4 text-institutional border-gray-300 rounded focus:ring-institutional"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"metadata",children:"Preservar Metadatos"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Mantener título, autor y propiedades del primer PDF"})]}),e.jsx("input",{id:"metadata",type:"checkbox",checked:l.preserveMetadata,onChange:s=>y({...l,preserveMetadata:s.target.checked}),className:"h-4 w-4 text-institutional border-gray-300 rounded focus:ring-institutional"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"pageNumbers",children:"Agregar Números de Página"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Numerar las páginas en el PDF unificado"})]}),e.jsx("input",{id:"pageNumbers",type:"checkbox",checked:l.addPageNumbers,onChange:s=>y({...l,addPageNumbers:s.target.checked}),className:"h-4 w-4 text-institutional border-gray-300 rounded focus:ring-institutional"})]})]}),e.jsxs("div",{className:"space-y-3","data-tour":"actions",children:[e.jsx(m,{onClick:ae,disabled:t.length<2||S,className:"w-full bg-institutional hover:bg-institutional/90",children:S?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}),R]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Unir PDFs"]})}),e.jsxs(m,{onClick:H,variant:"outline",className:"w-full border-institutional text-institutional hover:bg-institutional/10",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"¿Cómo funciona? - Tour Interactivo"]})]})]})]})})]})})})]})]})}export{Te as default};
