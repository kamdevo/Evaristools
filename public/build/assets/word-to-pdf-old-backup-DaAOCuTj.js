import{r as i,j as e,H as C}from"./app-BUl2XNVK.js";import{B as m}from"./createLucideIcon-nQgsIK04.js";import{T as D,a as l}from"./ToolCard-DUmtgb5y.js";import{F as N}from"./FileUploadZone-Dme-ExYg.js";import{P as b}from"./ProgressBar-18-o6m3Z.js";import{F as I}from"./file-down-B9zX4R8P.js";import{U as j}from"./upload-BNlRWnz8.js";import{F as T}from"./file-text-CLErbyE6.js";import{L as E}from"./loader-circle-DdpJ5jv-.js";import"./app-Cr7akxs5.js";import"./badge-ClX4IzPs.js";import"./arrow-left-C3I9wMLH.js";import"./building-2-DsJ5nUpW.js";function G(){const[o,x]=i.useState(null),[c,u]=i.useState(!1),[s,a]=i.useState({current:0,total:0,message:""}),[S,d]=i.useState(!1),p=i.useRef(null),h=t=>{const r=t[0];if(!r)return;if(!["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"].includes(r.type)){alert("Por favor selecciona un archivo Word válido (.docx o .doc).");return}x(r)},w=async()=>{if(!(!htmlContent||!o)){u(!0),a({current:0,total:3,message:"Preparando conversión a PDF..."});try{a({current:1,total:3,message:"Configurando opciones de PDF..."});const t={margin:options.margin,filename:`${o.name.replace(/\.(docx?|doc)$/i,"")}.pdf`,image:{type:"jpeg",quality:options.quality},html2canvas:{scale:2,useCORS:!0,allowTaint:!0},jsPDF:{unit:"mm",format:options.format,orientation:options.orientation}};a({current:2,total:3,message:"Generando PDF..."});const r=document.createElement("iframe");r.style.position="absolute",r.style.left="-9999px",r.style.top="0",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);const n=r.contentDocument||r.contentWindow?.document;if(!n)throw new Error("No se pudo crear el documento aislado para la conversión");n.open(),n.write(htmlContent),n.close(),await new Promise(f=>{r.contentWindow?r.contentWindow.addEventListener("load",f):setTimeout(f,100)});const v=n.body;if(!v)throw new Error("No se pudo acceder al contenido del documento");await html2pdf().set(t).from(v).save(),document.body.removeChild(r),a({current:3,total:3,message:"¡PDF generado y descargado exitosamente!"}),setIsConverted(!0)}catch(t){console.error("Error converting to PDF:",t),console.error("Error details:",{message:t instanceof Error?t.message:"Unknown error",stack:t instanceof Error?t.stack:void 0,errorType:typeof t,fullError:JSON.stringify(t,null,2)});const r=t instanceof Error?`Error al generar el PDF: ${t.message}`:"Error desconocido al generar el PDF. Revisa la consola para más detalles.";alert(r),a({current:0,total:0,message:"Error en la conversión"})}finally{u(!1)}}},g=t=>{t.preventDefault(),d(!0)},P=t=>{t.preventDefault(),d(!1)},F=t=>{t.preventDefault(),d(!1),t.dataTransfer.files&&t.dataTransfer.files.length>0&&h(t.dataTransfer.files)},y=()=>{x(null),setHtmlContent(""),setIsConverted(!1),setShowPreview(!1),a({current:0,total:0,message:""}),p.current&&(p.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Word a PDF - Evaristools",children:e.jsx("meta",{name:"description",content:"Convierte documentos Word a PDF manteniendo el formato - Hospital Universitario del Valle"})}),e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-900",children:[e.jsx(D,{title:"Word a PDF",description:"Convierte documentos Word a formato PDF manteniendo el formato original",icon:I}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{title:"Subir Documento Word",description:"Selecciona un archivo Word (.docx o .doc) para convertir a PDF.",icon:j,children:e.jsx(N,{onFileSelect:h,acceptedTypes:".docx,.doc,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword",multiple:!1,dragOver:S,onDragOver:g,onDragEnter:g,onDragLeave:P,onDrop:F,title:"Arrastra un documento Word aquí o haz clic para seleccionar",subtitle:"Archivos soportados: .docx, .doc",buttonText:"Seleccionar Documento"})}),o&&htmlContent&&e.jsx(l,{title:"Opciones de Conversión",description:"Configura el formato del PDF resultante",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Label,{htmlFor:"format",children:"Formato de página"}),e.jsxs(Select,{value:options.format,onValueChange:t=>setOptions({...options,format:t}),children:[e.jsx(SelectTrigger,{children:e.jsx(SelectValue,{})}),e.jsxs(SelectContent,{children:[e.jsx(SelectItem,{value:"a4",children:"A4"}),e.jsx(SelectItem,{value:"letter",children:"Carta"}),e.jsx(SelectItem,{value:"legal",children:"Legal"}),e.jsx(SelectItem,{value:"a3",children:"A3"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Label,{htmlFor:"orientation",children:"Orientación"}),e.jsxs(Select,{value:options.orientation,onValueChange:t=>setOptions({...options,orientation:t}),children:[e.jsx(SelectTrigger,{children:e.jsx(SelectValue,{})}),e.jsxs(SelectContent,{children:[e.jsx(SelectItem,{value:"portrait",children:"Vertical"}),e.jsx(SelectItem,{value:"landscape",children:"Horizontal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Label,{htmlFor:"margin",children:"Márgenes (mm)"}),e.jsxs(Select,{value:options.margin.toString(),onValueChange:t=>setOptions({...options,margin:parseInt(t)}),children:[e.jsx(SelectTrigger,{children:e.jsx(SelectValue,{})}),e.jsxs(SelectContent,{children:[e.jsx(SelectItem,{value:"5",children:"5mm (Mínimo)"}),e.jsx(SelectItem,{value:"10",children:"10mm (Pequeño)"}),e.jsx(SelectItem,{value:"15",children:"15mm (Normal)"}),e.jsx(SelectItem,{value:"20",children:"20mm (Grande)"}),e.jsx(SelectItem,{value:"25",children:"25mm (Máximo)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Label,{htmlFor:"quality",children:"Calidad"}),e.jsxs(Select,{value:options.quality.toString(),onValueChange:t=>setOptions({...options,quality:parseFloat(t)}),children:[e.jsx(SelectTrigger,{children:e.jsx(SelectValue,{})}),e.jsxs(SelectContent,{children:[e.jsx(SelectItem,{value:"1",children:"Básica"}),e.jsx(SelectItem,{value:"1.5",children:"Buena"}),e.jsx(SelectItem,{value:"2",children:"Alta"}),e.jsx(SelectItem,{value:"3",children:"Máxima"})]})]})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[c&&e.jsxs(l,{title:"Progreso de Conversión",children:[e.jsx(b,{progress:s.total>0?s.current/s.total*100:0,message:s.message,showPercentage:s.total>0}),s.total>0&&e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 text-center mt-2",children:["Paso ",s.current,"/",s.total]})]}),o&&e.jsxs(l,{title:"Documento Seleccionado",description:"Información del archivo Word",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(T,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:o.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(o.size/1024/1024).toFixed(2)," MB"]})]})]})}),htmlContent&&e.jsx("div",{className:"mt-4",children:e.jsxs(m,{onClick:()=>setShowPreview(!showPreview),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(Eye,{className:"mr-2 h-4 w-4"}),showPreview?"Ocultar Vista Previa":"Mostrar Vista Previa"]})})]}),showPreview&&htmlContent&&e.jsx(l,{title:"Vista Previa",description:"Contenido del documento que será convertido",children:e.jsx("div",{className:"max-h-96 overflow-y-auto border border-slate-200 dark:border-slate-700 rounded-lg p-4 bg-white dark:bg-slate-800",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:htmlContent},className:"prose prose-sm max-w-none dark:prose-invert"})})}),o&&htmlContent&&e.jsxs(l,{title:"Generar PDF",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(m,{onClick:w,disabled:c,className:"flex-1 bg-institutional hover:bg-institutional/90",children:c?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}),"Convirtiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Download,{className:"mr-2 h-4 w-4"}),"Convertir a PDF"]})}),e.jsxs(m,{onClick:y,variant:"outline",className:"flex-1",disabled:c,children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Seleccionar Otro"]})]}),isConverted&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800 dark:text-green-200 text-center",children:"✅ ¡PDF generado y descargado exitosamente!"})})]})]})]})})})]})]})}export{G as default};
